<!DOCTYPE html>
<html lang="es">
  <head>
<script>
// Early global helpers to ensure availability before any calls
window.normalizarId = window.normalizarId || function normalizarId(x) {
  let s = String(x ?? "")
    .normalize("NFKC")
    .replace(/[\u200B\u200C\u200D\u2060\uFEFF]/g, "")
    .replace(/[\u00A0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/g, " ")
    .replace(/\s+/g, " ")
    .trim();

  if (!s) return "";

  const stripZeros = (v) => v.replace(/^0+/, "") || "0";

  if (/^\d+$/.test(s)) return stripZeros(s);

  let m = s.match(/(\d+)\s*$/);
  if (m) return stripZeros(m[1]);

  if (s.includes("|")) {
    const right = s.split("|").pop();
    m = right.match(/(\d+)(?!.*\d)/);
    if (m) return stripZeros(m[1]);
  }

  const all = s.match(/\d+/g);
  if (all && all.length) return stripZeros(all[all.length - 1]);

  return s;
};

window.idKey = window.idKey || function idKey(x){ return window.normalizarId(x); };





/* ===== Geolocalizaci√≥n en tiempo real ===== */
document.addEventListener("DOMContentLoaded", function(){
  const GEO_MAX_KM = 8;
  const ORIGIN = (typeof map !== "undefined" && map.getCenter) ? map.getCenter() : {lat: 0, lng: 0};

  let geoWatchId = null;
  let userMarker = null;
  let accuracyCircle = null;
  let geoEnabled = false;

  const elGeoStatus = document.getElementById("geo-status");
  const elFarBanner = document.getElementById("far-banner");
  const btnOn  = document.getElementById("btn-geo-on");
  const btnOff = document.getElementById("btn-geo-off");

  function distKm(a, b) {
    const R = 6371;
    const toRad = (x) => x * Math.PI / 180;
    const dLat = toRad(b.lat - a.lat);
    const dLng = toRad(b.lng - a.lng);
    const la1 = toRad(a.lat), la2 = toRad(b.lat);
    const x = Math.sin(dLat/2)**2 + Math.cos(la1)*Math.cos(la2)*Math.sin(dLng/2)**2;
    const d = 2 * R * Math.asin(Math.sqrt(x));
    return d;
  }

  function setRegistroHabilitado(enabled){
    const btnRegistrar = document.getElementById("btn-registrar");
    if (btnRegistrar) {
      btnRegistrar.disabled = !enabled;
      btnRegistrar.classList.toggle("disabled-by-geo", !enabled);
    }
    document.querySelectorAll('[data-requires-geo="true"]').forEach(el=>{
      if ('disabled' in el) el.disabled = !enabled;
      el.classList.toggle("disabled-by-geo", !enabled);
    });
  }

  function updateGeoUI(lat, lng, acc){
    const d = distKm({lat: lat, lng: lng}, ORIGIN);
    if (elGeoStatus) elGeoStatus.textContent = `üìç ${lat.toFixed(5)}, ${lng.toFixed(5)} ‚Ä¢ ¬±${Math.round(acc||0)} m ‚Ä¢ ${d.toFixed(2)} km`;
    const lejos = d > GEO_MAX_KM;

    if (elFarBanner) elFarBanner.style.display = lejos ? "block" : "none";
    setRegistroHabilitado(!lejos);

    const pos = L.latLng(lat, lng);
    if (!userMarker) {
      userMarker = L.marker(pos).addTo(map).bindTooltip("Tu posici√≥n");
    } else {
      userMarker.setLatLng(pos);
    }
    if (!accuracyCircle) {
      accuracyCircle = L.circle(pos, { radius: acc||20, color: "#2563eb", fillColor: "#60a5fa", fillOpacity: 0.2 }).addTo(map);
    } else {
      accuracyCircle.setLatLng(pos);
      accuracyCircle.setRadius(acc||20);
    }
  }

  function setButtons(on){
    if (btnOn)  btnOn.disabled  = on;
    if (btnOff) btnOff.disabled = !on;
  }

  function startGeo(){
    if (!navigator.geolocation) {
      if (elGeoStatus) elGeoStatus.textContent = "Geolocalizaci√≥n no soportada.";
      setButtons(false);
      return;
    }
    if (geoWatchId) return;
    geoEnabled = true;
    setButtons(true);

    geoWatchId = navigator.geolocation.watchPosition(
      (pos) => {
        const { latitude, longitude, accuracy } = pos.coords;
        updateGeoUI(latitude, longitude, accuracy);
      },
      (err) => {
        if (elGeoStatus) elGeoStatus.textContent = `Error: ${err.message}`;
      },
      { enableHighAccuracy: true, maximumAge: 5000, timeout: 15000 }
    );
  }

  function stopGeo(){
    geoEnabled = false;
    setButtons(false);
    if (geoWatchId) {
      navigator.geolocation.clearWatch(geoWatchId);
      geoWatchId = null;
    }
    if (elGeoStatus) elGeoStatus.textContent = "‚Äî";
    if (userMarker) { map.removeLayer(userMarker); userMarker = null; }
    if (accuracyCircle) { map.removeLayer(accuracyCircle); accuracyCircle = null; }
    if (elFarBanner) elFarBanner.style.display = "none";
    setRegistroHabilitado(true);
  }

  // Delegaci√≥n para ON/OFF (robusto aunque los botones se re-rendericen)
  document.addEventListener("click", (e) => {
    const on  = e.target.closest && e.target.closest("#btn-geo-on");
    const off = e.target.closest && e.target.closest("#btn-geo-off");
    if (on)  { startGeo(); return; }
    if (off) { stopGeo();  return; }
  });

  // Estado inicial: OFF
  setButtons(false);
  if (elGeoStatus) elGeoStatus.textContent = "‚Äî";

  // Exponer helpers
  window.__geo = { startGeo, stopGeo };
});

</script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Territorios Salinas</title>

    <!-- Leaflet -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />

    <!-- (Opcional) Leaflet.Draw CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css"
    />

    <style>
      #map {
        height: 900px;
        width: 100%;
      }
      #info-panel {
        position: fixed;
        width: 10%;
        top: 50%;
        left: 50px;
        height: 10%;
        overflow-y: auto;
        background: rgba(0, 0, 0, 0.8);
        color: #fff;
        padding: 15px;
        border-radius: 10px;
        font-family: Arial, sans-serif;
        box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.5);
        z-index: 1000;
        visibility: hidden;
      }
      .label {
        font-size: 14px;
        font-weight: bold;
        background: #fff;
        padding: 2px;
        border-radius: 5px;
      }
      .tooltip-content {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .hidden {
        display: none;
      }

      #referencias,
      #ranking-container,
      #contador-poligonos {
        position: fixed;
        background: rgba(0, 0, 0, 0.8);
        color: #fff;
        padding: 15px;
        border-radius: 10px;
        font-family: Arial, sans-serif;
        box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.5);
        z-index: 1000;
        visibility: hidden;
      }
      #referencias {
        top: 10px;
        left: 50px;
        width: 250px;
        max-height: 400px;
        overflow-y: auto;
      }
      #ranking-container {
        top: 10px;
        right: 10px;
        width: 250px;
        max-height: 400px;
        overflow-y: auto;
      }
      #contador-poligonos {
        bottom: 10px;
        right: 10px;
        width: 250px;
        max-height: 400px;
        overflow-y: auto;
      }

      .referencias {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 0;
      }
      .referencia {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .color-box {
        width: 20px;
        height: 20px;
        border: 1px solid #000;
      }
      .azul {
        background: rgb(9, 0, 128);
      }
      .verde {
        background: green;
      }
      .amarillo {
        background: yellow;
      }
      .rojo {
        background: red;
      }

      #ranking-container h3 {
        font-size: 16px;
        margin-bottom: 10px;
        text-align: center;
        border-bottom: 1px solid #fff;
        padding-bottom: 5px;
      }
      #ranking-container ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }
      #ranking-container li {
        font-size: 14px;
        margin: 5px 0;
      }
       #toggle-referencias {
        position: fixed;
        bottom: 80px;
        left: 10px;
        padding: 10px 15px;
        background: #000;
        color: #fff;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        z-index: 1100;
        display: none; /* Oculto por defecto */
      }

      /*=== Estilo Responsivo=== */
      @media (max-width: 768px) {
        #referencias,
        #ranking-container,
        #contador-poligonos,
        #info-panel {
          display: none;
        }

        #referencias {
          right: 10px;
          font-size: 10px;
          width: 150px;
          top: 10px;
          left: auto;
        }
        .color-box {
          width: 10px;
          height: 10px;
        }

        #ranking-container {
          width: 150px;
          top: 180px;
        }
        #ranking-container li {
          font-size: 10px;
          margin: 4px 0;
        }

        #info-panel {
          width: 150px;
          right: 10px;
          top: 590px;
          height: auto;
          font-size: 10px;
        }

        #contador-poligonos {
          width: 150px;
          font-size: 10px;
          top: 680px;
        }

        #toggle-referencias {
          display: hidden;
          top: 100px;
          height: 50px;
        }

        /* Animaci√≥n de escala */
        @keyframes scaleDown {
          0% {
            transform: scale(1);
          }
          50% {
            transform: scale(0.9);
          }
          100% {
            transform: scale(1);
          }
        }

        #toggle-referencias.animate {
          animation: scaleDown 200ms ease-in-out;
        }
      }

      
      
      

      #far-banner {
        position: fixed; top: 10px; left: 50%; transform: translateX(-50%);
        z-index: 1300; padding: 10px 14px; border-radius: 10px;
        background: #3b1d1d; color: #ffdede; border: 1px solid #7a2e2e;
        font-family: Arial, sans-serif; box-shadow: 2px 2px 10px rgba(0,0,0,.5);
        display: none;
      }
      #far-banner strong { color:#ffb4b4; }

      .disabled-by-geo { opacity: .6; pointer-events: none; }

            /* --- Bottom action bar (responsive) --- */
      .bottom-bar {
        position: fixed;
        left: 0; right: 0; bottom: 0;
        background: #0a0a0a;
        color: #fff;
        z-index: 1400;
        padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
        border-top: 1px solid rgba(255,255,255,.08);
        display: flex; gap: 10px; align-items: center; justify-content: space-between;
        flex-wrap: wrap;
      }
      .bottom-bar .group {
        display: inline-flex; gap: 8px; align-items: center; flex: 1 1 auto; min-width: 180px;
      }
      .bar-btn-login {
        appearance: none;
        background: #111; color: #fff;
        border: 1px solid #333;
        border-radius: 12px;
        min-height: 42px;
        padding: 8px 14px;
        font-weight: 700;
        cursor: pointer;
        flex: 0 0 auto;
        margin-left: auto;
      }
      .bar-btn-login[disabled] { opacity:.6; cursor:not-allowed; }
      .bar-btn {
        appearance: none;
        background: #111; color: #fff;
        border: 1px solid #333;
        border-radius: 12px;
        min-height: 42px;
        padding: 8px 14px;
        font-weight: 700;
        cursor: pointer;
        flex: 0 0 auto;
      }
      .bar-btn[disabled] { opacity:.6; cursor:not-allowed; }
      .bar-text { font-size: 12px; color: #bbb; white-space: nowrap; }
      .bar-spacer { flex: 1 1 auto; }

      /* En m√≥viles, manten√© simple: solo botones */
      @media (max-width: 640px) {
        .bottom-bar { padding-left: 10px; padding-right: 10px; }
        .bar-text { display:none; }
      }

      /* Evitar que la barra tape el mapa / contenido */
      body { padding-bottom: calc(70px + env(safe-area-inset-bottom)); }

    
/* --- Bottom action bar (responsive) --- */
.bottom-bar {
  position: fixed;
  left: 0; right: 0; bottom: 0;
  background: #0a0a0a;
  color: #fff;
  z-index: 1400;
  padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
  border-top: 1px solid rgba(255,255,255,.08);
  display: flex; gap: 10px; align-items: center; justify-content: space-between;
  flex-wrap: wrap;
}
.bottom-bar .group {
  display: inline-flex; gap: 8px; align-items: center; flex: 1 1 auto; min-width: 180px; width: 100%;
}
.bar-btn {
  appearance: none;
  background: #111; color: #fff;
  border: 1px solid #333;
  border-radius: 12px;
  min-height: 42px;
  padding: 8px 14px;
  font-weight: 700;
  cursor: pointer;
  flex: 0 0 auto;
}
.bar-btn[disabled] { opacity:.6; cursor:not-allowed; }
.bar-text { font-size: 12px; color: #bbb; white-space: nowrap; }
.bar-spacer { flex: 1 1 auto; }
@media (max-width: 640px) {
  .bottom-bar { padding-left: 10px; padding-right: 10px; }
  .bar-text { display:none; }
}
body { padding-bottom: calc(70px + env(safe-area-inset-bottom)); }

</style>
  </head>
  <body>
    <div id="map"></div>
    <div id="far-banner">‚ö†Ô∏è Est√°s a m√°s de <strong>8 km</strong> del territorio. Las acciones quedaron desactivadas.</div>
<div id="info-panel">
      <p><strong>Territorio:</strong> <span id="polygon-id"></span></p>
      <p><strong>√öltima visita:</strong> <span id="polygon-fecha"></span></p>
    </div>

    <div id="referencias">
      <h3 style="margin-top: 0">Referencias</h3>
      <div class="referencias">
        <div class="referencia">
          <div class="color-box azul"></div>
          <span>Se est√° trabajando</span>
        </div>
        <div class="referencia">
          <div class="color-box verde"></div>
          <span>Menos de 2 meses (finalizado)</span>
        </div>
        <div class="referencia">
          <div class="color-box amarillo"></div>
          <span>M√°s de 2 y menos de 3 meses</span>
        </div>
        <div class="referencia">
          <div class="color-box rojo"></div>
          <span>3 meses o m√°s</span>
        </div>
      </div>
    </div>

    <div id="contador-poligonos">
      <h3>Estado de territorios</h3>
      <p>Trabajando: <span id="contador-azul">0</span></p>
      <p>Realizados: <span id="contador-verde">0</span></p>
      <p>Realizar: <span id="contador-amarillo">0</span></p>
      <p>Urgentes: <span id="contador-rojo">0</span></p>
    </div>

    <div id="ranking-container"></div>
    <button id="toggle-referencias">üìã Ver Informaci√≥n</button>
    <script>
      /*************** CONFIG ***************/
    const SHEET_CSV =
      'https://docs.google.com/spreadsheets/d/e/2PACX-1vS-TxyDU1xvaMwDjc5GQxjglSfBUYTUyu2_NDcAsJ_v0ngaD8g_-WcmxsUd9921RF2q5I4bcscjsf6N/pub?gid=1159469350&single=true&output=csv';

      const N_RANK = 20;
      let contadores = { blue: 0, green: 0, yellow: 0, red: 0 };

      /*************** MAPA ***************/
      const map = L.map("map").setView([-34.77118, -55.856602], 18.5);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: "&copy; OpenStreetMap contributors",
      }).addTo(map);


      /*************** POL√çGONOS (tu dataset) ***************/
      var poligonos = [
  {
    "id": "9001",
    "territorio": "9",
    "coords": [
      [
        -34.783228,
        -55.838217
      ],
      [
        -34.783924,
        -55.839719
      ],
      [
        -34.782853,
        -55.840437
      ],
      [
        -34.782188,
        -55.839
      ],
      [
        -34.782104,
        -55.838522
      ]
    ]
  },
  {
    "id": "9004",
    "territorio": "9",
    "coords": [
      [
        -34.782888,
        -55.840507
      ],
      [
        -34.783946,
        -55.839788
      ],
      [
        -34.784796,
        -55.841687
      ],
      [
        -34.783748,
        -55.842412
      ]
    ]
  },
  {
    "id": "9002",
    "territorio": "9",
    "coords": [
      [
        -34.782871,
        -55.842642
      ],
      [
        -34.78369,
        -55.842454
      ],
      [
        -34.782818,
        -55.840534
      ],
      [
        -34.782479,
        -55.840636
      ]
    ]
  },
  {
    "id": "9001",
    "territorio": "9",
    "coords": [
      [
        -34.782888,
        -55.842707
      ],
      [
        -34.783721,
        -55.842513
      ],
      [
        -34.784585,
        -55.844412
      ],
      [
        -34.783254,
        -55.844766
      ]
    ]
  },
  {
    "id": "9005",
    "territorio": "9",
    "coords": [
      [
        -34.783783,
        -55.842481
      ],
      [
        -34.784259,
        -55.842138
      ],
      [
        -34.78462,
        -55.842943
      ],
      [
        -34.784567,
        -55.843028
      ],
      [
        -34.784567,
        -55.843141
      ],
      [
        -34.784219,
        -55.843415
      ]
    ]
  },
  {
    "id": "9006",
    "territorio": "9",
    "coords": [
      [
        -34.784677,
        -55.842916
      ],
      [
        -34.784312,
        -55.842116
      ],
      [
        -34.784836,
        -55.841746
      ],
      [
        -34.785246,
        -55.842701
      ],
      [
        -34.784862,
        -55.842969
      ],
      [
        -34.784752,
        -55.842894
      ]
    ]
  },
  {
    "id": "9007",
    "territorio": "9",
    "coords": [
      [
        -34.78425,
        -55.843474
      ],
      [
        -34.784585,
        -55.843222
      ],
      [
        -34.784651,
        -55.843286
      ],
      [
        -34.784801,
        -55.843302
      ],
      [
        -34.78514,
        -55.84408
      ],
      [
        -34.784664,
        -55.84438
      ]
    ]
  },
  {
    "id": "9008",
    "territorio": "9",
    "coords": [
      [
        -34.784889,
        -55.843045
      ],
      [
        -34.785276,
        -55.84276
      ],
      [
        -34.785691,
        -55.843688
      ],
      [
        -34.785202,
        -55.844021
      ],
      [
        -34.784831,
        -55.843259
      ],
      [
        -34.784889,
        -55.843152
      ]
    ]
  },
  {
    "id": "10005",
    "territorio": "10",
    "coords": [
      [
        -34.783422,
        -55.845791
      ],
      [
        -34.783259,
        -55.844826
      ],
      [
        -34.784642,
        -55.844466
      ],
      [
        -34.785047,
        -55.845394
      ]
    ]
  },
  {
    "id": "10006",
    "territorio": "10",
    "coords": [
      [
        -34.784686,
        -55.84445
      ],
      [
        -34.78573,
        -55.843747
      ],
      [
        -34.786761,
        -55.846006
      ],
      [
        -34.785532,
        -55.846338
      ]
    ]
  },
  {
    "id": "10004",
    "territorio": "10",
    "coords": [
      [
        -34.783624,
        -55.846843
      ],
      [
        -34.78343,
        -55.845855
      ],
      [
        -34.785069,
        -55.845442
      ],
      [
        -34.785466,
        -55.84636
      ]
    ]
  },
  {
    "id": "10003",
    "territorio": "10",
    "coords": [
      [
        -34.783646,
        -55.846955
      ],
      [
        -34.785506,
        -55.846456
      ],
      [
        -34.785642,
        -55.847459
      ],
      [
        -34.783809,
        -55.847932
      ]
    ]
  },
  {
    "id": "10007",
    "territorio": "10",
    "coords": [
      [
        -34.785655,
        -55.847079
      ],
      [
        -34.785558,
        -55.846435
      ],
      [
        -34.78681,
        -55.846108
      ],
      [
        -34.787083,
        -55.846703
      ]
    ]
  },
  {
    "id": "10008",
    "territorio": "10",
    "coords": [
      [
        -34.78581,
        -55.848071
      ],
      [
        -34.785673,
        -55.847154
      ],
      [
        -34.787127,
        -55.846762
      ],
      [
        -34.787484,
        -55.84762
      ]
    ]
  },
  {
    "id": "10002",
    "territorio": "10",
    "coords": [
      [
        -34.783818,
        -55.848001
      ],
      [
        -34.785647,
        -55.847524
      ],
      [
        -34.785818,
        -55.848463
      ],
      [
        -34.783977,
        -55.84894
      ]
    ]
  },
  {
    "id": "10001",
    "territorio": "10",
    "coords": [
      [
        -34.783981,
        -55.849015
      ],
      [
        -34.785832,
        -55.848554
      ],
      [
        -34.786003,
        -55.849487
      ],
      [
        -34.784166,
        -55.849997
      ]
    ]
  },
  {
    "id": "10009",
    "territorio": "10",
    "coords": [
      [
        -34.785823,
        -55.848135
      ],
      [
        -34.787523,
        -55.847674
      ],
      [
        -34.787797,
        -55.848307
      ],
      [
        -34.787955,
        -55.848618
      ],
      [
        -34.786003,
        -55.849128
      ]
    ]
  },
  {
    "id": "10010",
    "territorio": "10",
    "coords": [
      [
        -34.786021,
        -55.849208
      ],
      [
        -34.78799,
        -55.848666
      ],
      [
        -34.78833,
        -55.84916
      ],
      [
        -34.788532,
        -55.849594
      ],
      [
        -34.786268,
        -55.850211
      ],
      [
        -34.786092,
        -55.849589
      ]
    ]
  },
  {
    "id": "11007",
    "territorio": "11",
    "coords": [
      [
        -34.780033,
        -55.851059
      ],
      [
        -34.78406,
        -55.849965
      ],
      [
        -34.783902,
        -55.849053
      ],
      [
        -34.779919,
        -55.850158
      ]
    ]
  },
  {
    "id": "11008",
    "territorio": "11",
    "coords": [
      [
        -34.779901,
        -55.850018
      ],
      [
        -34.779725,
        -55.849117
      ],
      [
        -34.783734,
        -55.848044
      ],
      [
        -34.783867,
        -55.848956
      ]
    ]
  },
  {
    "id": "11009",
    "territorio": "11",
    "coords": [
      [
        -34.77969,
        -55.848988
      ],
      [
        -34.781646,
        -55.848463
      ],
      [
        -34.781479,
        -55.847518
      ],
      [
        -34.779531,
        -55.848109
      ]
    ]
  },
  {
    "id": "11010",
    "territorio": "11",
    "coords": [
      [
        -34.781734,
        -55.848452
      ],
      [
        -34.781593,
        -55.84754
      ],
      [
        -34.783567,
        -55.847025
      ],
      [
        -34.783708,
        -55.847948
      ]
    ]
  },
  {
    "id": "11004",
    "territorio": "11",
    "coords": [
      [
        -34.778156,
        -55.851542
      ],
      [
        -34.777998,
        -55.850673
      ],
      [
        -34.779822,
        -55.850179
      ],
      [
        -34.779928,
        -55.851113
      ]
    ]
  },
  {
    "id": "11005",
    "territorio": "11",
    "coords": [
      [
        -34.777998,
        -55.850523
      ],
      [
        -34.779778,
        -55.850061
      ],
      [
        -34.779602,
        -55.849117
      ],
      [
        -34.777839,
        -55.849621
      ]
    ]
  },
  {
    "id": "11006",
    "territorio": "11",
    "coords": [
      [
        -34.777804,
        -55.849503
      ],
      [
        -34.777654,
        -55.84857
      ],
      [
        -34.779443,
        -55.84813
      ],
      [
        -34.779584,
        -55.84902
      ]
    ]
  },
  {
    "id": "11001",
    "territorio": "11",
    "coords": [
      [
        -34.777381,
        -55.851756
      ],
      [
        -34.778051,
        -55.851585
      ],
      [
        -34.777874,
        -55.850673
      ],
      [
        -34.777213,
        -55.850877
      ]
    ]
  },
  {
    "id": "11002",
    "territorio": "11",
    "coords": [
      [
        -34.777187,
        -55.850716
      ],
      [
        -34.777874,
        -55.850533
      ],
      [
        -34.777725,
        -55.849664
      ],
      [
        -34.776993,
        -55.849857
      ]
    ]
  },
  {
    "id": "11003",
    "territorio": "11",
    "coords": [
      [
        -34.776993,
        -55.849696
      ],
      [
        -34.777716,
        -55.849514
      ],
      [
        -34.777548,
        -55.848613
      ],
      [
        -34.776817,
        -55.848817
      ]
    ]
  },
  {
    "id": "7013",
    "territorio": "7",
    "coords": [
      [
        -34.782593,
        -55.847111
      ],
      [
        -34.783554,
        -55.846859
      ],
      [
        -34.783197,
        -55.844836
      ],
      [
        -34.782236,
        -55.845121
      ]
    ]
  },
  {
    "id": "7011",
    "territorio": "7",
    "coords": [
      [
        -34.781536,
        -55.847384
      ],
      [
        -34.782523,
        -55.847138
      ],
      [
        -34.782175,
        -55.845126
      ],
      [
        -34.78117,
        -55.845394
      ]
    ]
  },
  {
    "id": "7009",
    "territorio": "7",
    "coords": [
      [
        -34.780562,
        -55.847658
      ],
      [
        -34.781479,
        -55.847411
      ],
      [
        -34.781108,
        -55.845399
      ],
      [
        -34.780166,
        -55.845652
      ]
    ]
  },
  {
    "id": "7007",
    "territorio": "7",
    "coords": [
      [
        -34.779491,
        -55.847953
      ],
      [
        -34.7805,
        -55.847674
      ],
      [
        -34.780113,
        -55.845673
      ],
      [
        -34.779121,
        -55.845936
      ]
    ]
  },
  {
    "id": "7005",
    "territorio": "7",
    "coords": [
      [
        -34.778452,
        -55.848216
      ],
      [
        -34.77943,
        -55.847974
      ],
      [
        -34.77906,
        -55.845952
      ],
      [
        -34.778108,
        -55.84621
      ]
    ]
  },
  {
    "id": "7003",
    "territorio": "7",
    "coords": [
      [
        -34.777606,
        -55.848441
      ],
      [
        -34.778403,
        -55.848227
      ],
      [
        -34.778046,
        -55.84622
      ],
      [
        -34.777231,
        -55.846435
      ]
    ]
  },
  {
    "id": "7001",
    "territorio": "7",
    "coords": [
      [
        -34.776773,
        -55.848656
      ],
      [
        -34.777548,
        -55.848463
      ],
      [
        -34.777183,
        -55.84644
      ],
      [
        -34.776407,
        -55.846655
      ]
    ]
  },
  {
    "id": "7002",
    "territorio": "7",
    "coords": [
      [
        -34.776407,
        -55.846585
      ],
      [
        -34.777174,
        -55.846376
      ],
      [
        -34.776791,
        -55.844321
      ],
      [
        -34.776694,
        -55.844407
      ],
      [
        -34.776077,
        -55.844648
      ]
    ]
  },
  {
    "id": "7004",
    "territorio": "7",
    "coords": [
      [
        -34.776848,
        -55.844284
      ],
      [
        -34.777623,
        -55.843887
      ],
      [
        -34.778033,
        -55.846156
      ],
      [
        -34.777231,
        -55.84636
      ]
    ]
  },
  {
    "id": "7006",
    "territorio": "7",
    "coords": [
      [
        -34.77809,
        -55.84614
      ],
      [
        -34.779046,
        -55.845888
      ],
      [
        -34.778681,
        -55.843833
      ],
      [
        -34.777716,
        -55.844074
      ]
    ]
  },
  {
    "id": "7008",
    "territorio": "7",
    "coords": [
      [
        -34.779113,
        -55.845866
      ],
      [
        -34.780095,
        -55.845603
      ],
      [
        -34.779707,
        -55.843549
      ],
      [
        -34.778756,
        -55.843828
      ]
    ]
  },
  {
    "id": "7010",
    "territorio": "7",
    "coords": [
      [
        -34.780144,
        -55.845571
      ],
      [
        -34.779773,
        -55.843538
      ],
      [
        -34.780743,
        -55.843297
      ],
      [
        -34.7811,
        -55.845351
      ]
    ]
  },
  {
    "id": "7012",
    "territorio": "7",
    "coords": [
      [
        -34.781161,
        -55.845324
      ],
      [
        -34.780809,
        -55.843297
      ],
      [
        -34.781791,
        -55.843007
      ],
      [
        -34.782166,
        -55.845072
      ]
    ]
  },
  {
    "id": "7014",
    "territorio": "7",
    "coords": [
      [
        -34.782228,
        -55.845045
      ],
      [
        -34.783179,
        -55.844783
      ],
      [
        -34.782827,
        -55.842712
      ],
      [
        -34.781849,
        -55.842986
      ]
    ]
  },
  {
    "id": "8016",
    "territorio": "8",
    "coords": [
      [
        -34.781082,
        -55.838791
      ],
      [
        -34.782042,
        -55.838544
      ],
      [
        -34.782403,
        -55.840588
      ],
      [
        -34.781452,
        -55.840829
      ]
    ]
  },
  {
    "id": "8015",
    "territorio": "8",
    "coords": [
      [
        -34.781456,
        -55.840899
      ],
      [
        -34.782408,
        -55.840647
      ],
      [
        -34.782809,
        -55.842653
      ],
      [
        -34.781831,
        -55.842921
      ]
    ]
  },
  {
    "id": "8013",
    "territorio": "8",
    "coords": [
      [
        -34.780786,
        -55.843216
      ],
      [
        -34.781765,
        -55.842932
      ],
      [
        -34.781399,
        -55.840926
      ],
      [
        -34.780438,
        -55.841183
      ],
      [
        -34.780469,
        -55.841424
      ],
      [
        -34.780456,
        -55.841526
      ]
    ]
  },
  {
    "id": "8014",
    "territorio": "8",
    "coords": [
      [
        -34.780412,
        -55.841119
      ],
      [
        -34.781399,
        -55.840856
      ],
      [
        -34.78102,
        -55.838807
      ],
      [
        -34.780051,
        -55.839059
      ]
    ]
  },
  {
    "id": "8011",
    "territorio": "8",
    "coords": [
      [
        -34.77976,
        -55.843468
      ],
      [
        -34.779628,
        -55.842707
      ],
      [
        -34.780125,
        -55.842079
      ],
      [
        -34.780425,
        -55.841575
      ],
      [
        -34.780729,
        -55.843232
      ]
    ]
  },
  {
    "id": "8012",
    "territorio": "8",
    "coords": [
      [
        -34.77902,
        -55.839338
      ],
      [
        -34.779901,
        -55.839112
      ],
      [
        -34.780059,
        -55.840094
      ],
      [
        -34.779205,
        -55.840357
      ]
    ]
  },
  {
    "id": "8007",
    "territorio": "8",
    "coords": [
      [
        -34.778742,
        -55.843753
      ],
      [
        -34.779698,
        -55.843484
      ],
      [
        -34.77957,
        -55.842755
      ],
      [
        -34.778694,
        -55.843452
      ]
    ]
  },
  {
    "id": "8008",
    "territorio": "8",
    "coords": [
      [
        -34.778658,
        -55.843222
      ],
      [
        -34.77931,
        -55.842728
      ],
      [
        -34.779517,
        -55.842508
      ],
      [
        -34.779332,
        -55.841424
      ],
      [
        -34.778275,
        -55.84114
      ]
    ]
  },
  {
    "id": "8009",
    "territorio": "8",
    "coords": [
      [
        -34.779328,
        -55.841365
      ],
      [
        -34.779174,
        -55.840529
      ],
      [
        -34.778566,
        -55.840727
      ],
      [
        -34.778658,
        -55.841183
      ]
    ]
  },
  {
    "id": "8010",
    "territorio": "8",
    "coords": [
      [
        -34.777984,
        -55.839606
      ],
      [
        -34.778953,
        -55.839348
      ],
      [
        -34.779161,
        -55.840486
      ],
      [
        -34.7782,
        -55.840775
      ]
    ]
  },
  {
    "id": "8005",
    "territorio": "8",
    "coords": [
      [
        -34.777662,
        -55.843785
      ],
      [
        -34.778601,
        -55.843281
      ],
      [
        -34.778315,
        -55.841773
      ],
      [
        -34.777336,
        -55.842015
      ]
    ]
  },
  {
    "id": "8006",
    "territorio": "8",
    "coords": [
      [
        -34.777328,
        -55.841934
      ],
      [
        -34.778306,
        -55.841709
      ],
      [
        -34.778187,
        -55.84092
      ],
      [
        -34.777931,
        -55.839622
      ],
      [
        -34.776966,
        -55.839885
      ]
    ]
  },
  {
    "id": "8003",
    "territorio": "8",
    "coords": [
      [
        -34.776834,
        -55.844209
      ],
      [
        -34.77761,
        -55.843812
      ],
      [
        -34.777279,
        -55.842031
      ],
      [
        -34.776477,
        -55.842218
      ]
    ]
  },
  {
    "id": "8004",
    "territorio": "8",
    "coords": [
      [
        -34.77646,
        -55.842143
      ],
      [
        -34.777262,
        -55.841961
      ],
      [
        -34.7769,
        -55.839906
      ],
      [
        -34.776103,
        -55.840099
      ]
    ]
  },
  {
    "id": "8001",
    "territorio": "8",
    "coords": [
      [
        -34.776023,
        -55.84437
      ],
      [
        -34.776764,
        -55.844219
      ],
      [
        -34.77642,
        -55.842235
      ],
      [
        -34.775653,
        -55.842433
      ]
    ]
  },
  {
    "id": "8002",
    "territorio": "8",
    "coords": [
      [
        -34.775636,
        -55.842363
      ],
      [
        -34.776407,
        -55.842159
      ],
      [
        -34.776054,
        -55.840126
      ],
      [
        -34.775332,
        -55.840341
      ],
      [
        -34.775362,
        -55.840845
      ]
    ]
  },
  {
    "id": "36004",
    "territorio": "36",
    "coords": [
      [
        -34.78962,
        -55.852153
      ],
      [
        -34.788563,
        -55.849782
      ],
      [
        -34.78755,
        -55.850061
      ],
      [
        -34.788158,
        -55.851359
      ],
      [
        -34.788369,
        -55.851971
      ],
      [
        -34.788449,
        -55.852593
      ],
      [
        -34.789039,
        -55.852336
      ]
    ]
  },
  {
    "id": "36003",
    "territorio": "36",
    "coords": [
      [
        -34.786316,
        -55.850405
      ],
      [
        -34.787471,
        -55.850077
      ],
      [
        -34.787642,
        -55.850523
      ],
      [
        -34.788118,
        -55.851515
      ],
      [
        -34.788303,
        -55.852003
      ],
      [
        -34.788382,
        -55.852674
      ],
      [
        -34.787713,
        -55.853081
      ],
      [
        -34.787589,
        -55.85232
      ],
      [
        -34.787435,
        -55.851858
      ],
      [
        -34.787219,
        -55.851451
      ],
      [
        -34.786532,
        -55.850737
      ],
      [
        -34.786413,
        -55.850624
      ],
      [
        -34.786325,
        -55.85049
      ]
    ]
  },
  {
    "id": "36002",
    "territorio": "36",
    "coords": [
      [
        -34.786863,
        -55.853398
      ],
      [
        -34.786964,
        -55.853382
      ],
      [
        -34.787651,
        -55.853092
      ],
      [
        -34.787528,
        -55.852325
      ],
      [
        -34.787175,
        -55.85151
      ],
      [
        -34.786589,
        -55.850909
      ],
      [
        -34.786356,
        -55.850667
      ],
      [
        -34.786255,
        -55.850453
      ],
      [
        -34.786087,
        -55.849804
      ],
      [
        -34.78469,
        -55.850185
      ],
      [
        -34.784801,
        -55.85049
      ],
      [
        -34.784933,
        -55.850683
      ],
      [
        -34.785224,
        -55.850893
      ],
      [
        -34.785598,
        -55.851166
      ],
      [
        -34.785973,
        -55.851536
      ],
      [
        -34.786285,
        -55.851955
      ],
      [
        -34.786528,
        -55.852384
      ],
      [
        -34.786788,
        -55.85313
      ]
    ]
  },
  {
    "id": "36001",
    "territorio": "36",
    "coords": [
      [
        -34.783378,
        -55.85056
      ],
      [
        -34.78462,
        -55.850201
      ],
      [
        -34.784774,
        -55.85056
      ],
      [
        -34.784902,
        -55.850748
      ],
      [
        -34.785334,
        -55.851054
      ],
      [
        -34.785633,
        -55.851268
      ],
      [
        -34.785876,
        -55.85152
      ],
      [
        -34.786202,
        -55.851939
      ],
      [
        -34.786479,
        -55.852443
      ],
      [
        -34.78681,
        -55.853414
      ],
      [
        -34.786281,
        -55.853478
      ],
      [
        -34.785933,
        -55.853548
      ],
      [
        -34.785827,
        -55.853387
      ],
      [
        -34.785611,
        -55.852861
      ],
      [
        -34.785158,
        -55.852218
      ],
      [
        -34.784814,
        -55.851842
      ],
      [
        -34.784435,
        -55.851552
      ],
      [
        -34.783893,
        -55.851204
      ],
      [
        -34.783549,
        -55.850995
      ],
      [
        -34.783457,
        -55.85085
      ]
    ]
  },
  {
    "id": "35005",
    "territorio": "35",
    "coords": [
      [
        -34.782457,
        -55.850785
      ],
      [
        -34.783316,
        -55.850571
      ],
      [
        -34.783408,
        -55.850903
      ],
      [
        -34.783514,
        -55.851048
      ],
      [
        -34.784074,
        -55.851402
      ],
      [
        -34.784668,
        -55.851821
      ],
      [
        -34.785263,
        -55.852491
      ],
      [
        -34.785607,
        -55.853001
      ],
      [
        -34.785854,
        -55.853564
      ],
      [
        -34.785025,
        -55.853832
      ],
      [
        -34.784809,
        -55.853124
      ],
      [
        -34.784179,
        -55.852464
      ],
      [
        -34.783281,
        -55.851955
      ],
      [
        -34.782624,
        -55.851794
      ],
      [
        -34.782492,
        -55.851091
      ]
    ]
  },
  {
    "id": "35004",
    "territorio": "35",
    "coords": [
      [
        -34.782642,
        -55.851874
      ],
      [
        -34.783351,
        -55.852057
      ],
      [
        -34.784065,
        -55.852464
      ],
      [
        -34.784307,
        -55.852668
      ],
      [
        -34.784545,
        -55.85292
      ],
      [
        -34.78469,
        -55.853081
      ],
      [
        -34.784814,
        -55.853291
      ],
      [
        -34.784946,
        -55.85387
      ],
      [
        -34.784395,
        -55.854122
      ],
      [
        -34.784237,
        -55.854138
      ],
      [
        -34.784131,
        -55.85409
      ],
      [
        -34.783373,
        -55.853441
      ],
      [
        -34.78273,
        -55.852969
      ],
      [
        -34.782756,
        -55.852497
      ]
    ]
  },
  {
    "id": "35001",
    "territorio": "35",
    "coords": [
      [
        -34.780065,
        -55.85144
      ],
      [
        -34.782409,
        -55.850807
      ],
      [
        -34.782541,
        -55.851681
      ],
      [
        -34.782695,
        -55.852411
      ],
      [
        -34.782682,
        -55.852942
      ],
      [
        -34.782272,
        -55.852759
      ],
      [
        -34.781721,
        -55.852572
      ],
      [
        -34.781708,
        -55.851837
      ],
      [
        -34.78166,
        -55.851703
      ],
      [
        -34.781488,
        -55.851713
      ],
      [
        -34.781431,
        -55.851821
      ],
      [
        -34.781409,
        -55.852545
      ],
      [
        -34.781047,
        -55.852572
      ],
      [
        -34.780281,
        -55.852776
      ]
    ]
  },
  {
    "id": "35002",
    "territorio": "35",
    "coords": [
      [
        -34.780303,
        -55.852877
      ],
      [
        -34.781153,
        -55.852668
      ],
      [
        -34.781488,
        -55.852636
      ],
      [
        -34.781823,
        -55.852711
      ],
      [
        -34.782682,
        -55.853071
      ],
      [
        -34.783625,
        -55.8538
      ],
      [
        -34.784118,
        -55.854203
      ],
      [
        -34.783651,
        -55.854385
      ],
      [
        -34.782946,
        -55.85476
      ],
      [
        -34.782175,
        -55.854176
      ],
      [
        -34.781488,
        -55.853961
      ],
      [
        -34.781105,
        -55.853999
      ],
      [
        -34.780814,
        -55.854197
      ]
    ]
  },
  {
    "id": "35003",
    "territorio": "35",
    "coords": [
      [
        -34.781686,
        -55.855662
      ],
      [
        -34.782884,
        -55.854803
      ],
      [
        -34.782316,
        -55.854353
      ],
      [
        -34.781906,
        -55.854133
      ],
      [
        -34.781404,
        -55.854031
      ],
      [
        -34.781126,
        -55.854079
      ],
      [
        -34.780945,
        -55.85417
      ],
      [
        -34.780853,
        -55.854256
      ]
    ]
  },
  {
    "id": "26005",
    "territorio": "26",
    "coords": [
      [
        -34.779994,
        -55.854954
      ],
      [
        -34.780782,
        -55.854304
      ],
      [
        -34.78162,
        -55.85571
      ],
      [
        -34.780923,
        -55.856498
      ],
      [
        -34.780809,
        -55.856343
      ]
    ]
  },
  {
    "id": "26004",
    "territorio": "26",
    "coords": [
      [
        -34.780263,
        -55.857491
      ],
      [
        -34.780879,
        -55.856552
      ],
      [
        -34.780765,
        -55.856407
      ],
      [
        -34.779906,
        -55.854937
      ],
      [
        -34.779787,
        -55.854712
      ],
      [
        -34.779773,
        -55.854471
      ],
      [
        -34.779826,
        -55.854321
      ],
      [
        -34.779954,
        -55.85416
      ],
      [
        -34.780029,
        -55.854208
      ],
      [
        -34.780174,
        -55.854063
      ],
      [
        -34.780364,
        -55.854562
      ],
      [
        -34.780756,
        -55.85424
      ],
      [
        -34.780245,
        -55.852915
      ],
      [
        -34.779677,
        -55.853215
      ],
      [
        -34.779306,
        -55.85358
      ],
      [
        -34.77906,
        -55.853934
      ],
      [
        -34.779042,
        -55.854235
      ],
      [
        -34.778927,
        -55.854621
      ],
      [
        -34.778773,
        -55.854905
      ]
    ]
  },
  {
    "id": "26001",
    "territorio": "26",
    "coords": [
      [
        -34.777804,
        -55.855029
      ],
      [
        -34.777451,
        -55.852556
      ],
      [
        -34.777412,
        -55.852126
      ],
      [
        -34.780003,
        -55.851456
      ],
      [
        -34.780214,
        -55.852786
      ],
      [
        -34.780073,
        -55.852845
      ],
      [
        -34.779615,
        -55.853135
      ],
      [
        -34.779293,
        -55.853446
      ],
      [
        -34.779077,
        -55.853747
      ],
      [
        -34.778491,
        -55.852845
      ],
      [
        -34.77846,
        -55.852743
      ],
      [
        -34.778566,
        -55.852641
      ],
      [
        -34.779355,
        -55.852432
      ],
      [
        -34.779359,
        -55.852363
      ],
      [
        -34.778584,
        -55.852566
      ],
      [
        -34.77843,
        -55.852641
      ],
      [
        -34.778399,
        -55.852797
      ],
      [
        -34.779029,
        -55.853806
      ],
      [
        -34.77846,
        -55.854514
      ]
    ]
  },
  {
    "id": "26002",
    "territorio": "26",
    "coords": [
      [
        -34.77791,
        -55.855914
      ],
      [
        -34.778734,
        -55.854964
      ],
      [
        -34.779152,
        -55.855747
      ],
      [
        -34.778919,
        -55.856364
      ],
      [
        -34.778897,
        -55.856713
      ],
      [
        -34.779227,
        -55.85917
      ],
      [
        -34.779293,
        -55.859379
      ],
      [
        -34.778575,
        -55.861208
      ]
    ]
  },
  {
    "id": "26003",
    "territorio": "26",
    "coords": [
      [
        -34.779333,
        -55.859283
      ],
      [
        -34.780218,
        -55.857539
      ],
      [
        -34.779196,
        -55.855801
      ],
      [
        -34.778976,
        -55.856364
      ],
      [
        -34.778963,
        -55.85674
      ],
      [
        -34.779271,
        -55.859106
      ]
    ]
  },
  {
    "id": "27001",
    "territorio": "27",
    "coords": [
      [
        -34.778826,
        -55.862582
      ],
      [
        -34.77872,
        -55.861895
      ],
      [
        -34.779795,
        -55.858955
      ],
      [
        -34.780289,
        -55.859835
      ],
      [
        -34.779461,
        -55.862367
      ]
    ]
  },
  {
    "id": "27002",
    "territorio": "27",
    "coords": [
      [
        -34.779584,
        -55.862367
      ],
      [
        -34.782474,
        -55.861573
      ],
      [
        -34.781769,
        -55.860178
      ],
      [
        -34.781329,
        -55.860844
      ],
      [
        -34.779936,
        -55.861166
      ]
    ]
  },
  {
    "id": "33001",
    "territorio": "33",
    "coords": [
      [
        -34.779884,
        -55.85888
      ],
      [
        -34.780448,
        -55.857958
      ],
      [
        -34.78169,
        -55.86005
      ],
      [
        -34.781355,
        -55.860629
      ],
      [
        -34.780765,
        -55.860908
      ],
      [
        -34.780553,
        -55.860007
      ]
    ]
  },
  {
    "id": "33002",
    "territorio": "33",
    "coords": [
      [
        -34.780536,
        -55.85785
      ],
      [
        -34.781091,
        -55.85696
      ],
      [
        -34.781584,
        -55.857668
      ],
      [
        -34.781919,
        -55.858022
      ],
      [
        -34.781717,
        -55.859878
      ]
    ]
  },
  {
    "id": "27003",
    "territorio": "27",
    "coords": [
      [
        -34.781813,
        -55.86006
      ],
      [
        -34.781998,
        -55.858119
      ],
      [
        -34.782686,
        -55.858816
      ],
      [
        -34.782809,
        -55.858805
      ],
      [
        -34.782756,
        -55.859792
      ],
      [
        -34.783021,
        -55.861477
      ],
      [
        -34.782633,
        -55.861573
      ]
    ]
  },
  {
    "id": "27004",
    "territorio": "27",
    "coords": [
      [
        -34.783126,
        -55.861455
      ],
      [
        -34.78399,
        -55.861208
      ],
      [
        -34.783699,
        -55.859642
      ],
      [
        -34.783761,
        -55.858912
      ],
      [
        -34.782924,
        -55.85887
      ],
      [
        -34.782853,
        -55.859782
      ]
    ]
  },
  {
    "id": "27005",
    "territorio": "27",
    "coords": [
      [
        -34.784105,
        -55.861176
      ],
      [
        -34.784915,
        -55.86094
      ],
      [
        -34.78473,
        -55.859621
      ],
      [
        -34.784783,
        -55.858709
      ],
      [
        -34.783893,
        -55.858923
      ],
      [
        -34.783831,
        -55.859706
      ]
    ]
  },
  {
    "id": "33003",
    "territorio": "33",
    "coords": [
      [
        -34.781113,
        -55.856853
      ],
      [
        -34.781668,
        -55.856155
      ],
      [
        -34.783162,
        -55.85497
      ],
      [
        -34.783968,
        -55.855619
      ],
      [
        -34.783598,
        -55.856321
      ],
      [
        -34.78332,
        -55.856123
      ],
      [
        -34.783197,
        -55.856134
      ],
      [
        -34.782985,
        -55.856262
      ],
      [
        -34.782166,
        -55.857078
      ],
      [
        -34.781871,
        -55.857829
      ],
      [
        -34.781677,
        -55.857657
      ]
    ]
  },
  {
    "id": "33004",
    "territorio": "33",
    "coords": [
      [
        -34.781924,
        -55.857866
      ],
      [
        -34.782197,
        -55.857142
      ],
      [
        -34.7831,
        -55.856268
      ],
      [
        -34.78325,
        -55.856155
      ],
      [
        -34.783576,
        -55.856375
      ],
      [
        -34.783056,
        -55.857453
      ],
      [
        -34.783012,
        -55.857598
      ],
      [
        -34.782866,
        -55.858762
      ],
      [
        -34.782765,
        -55.858714
      ]
    ]
  },
  {
    "id": "33004",
    "territorio": "33",
    "coords": [
      [
        -34.782919,
        -55.858768
      ],
      [
        -34.783809,
        -55.858832
      ],
      [
        -34.783933,
        -55.857893
      ],
      [
        -34.784805,
        -55.856182
      ],
      [
        -34.784021,
        -55.855672
      ],
      [
        -34.783153,
        -55.857357
      ],
      [
        -34.783043,
        -55.857727
      ]
    ]
  },
  {
    "id": "33006",
    "territorio": "33",
    "coords": [
      [
        -34.783875,
        -55.858816
      ],
      [
        -34.784809,
        -55.858623
      ],
      [
        -34.784845,
        -55.858381
      ],
      [
        -34.785735,
        -55.856579
      ],
      [
        -34.784862,
        -55.856214
      ],
      [
        -34.783981,
        -55.857925
      ]
    ]
  },
  {
    "id": "34001",
    "territorio": "34",
    "coords": [
      [
        -34.784867,
        -55.858591
      ],
      [
        -34.784898,
        -55.858376
      ],
      [
        -34.785796,
        -55.856616
      ],
      [
        -34.786444,
        -55.856826
      ],
      [
        -34.786849,
        -55.856767
      ],
      [
        -34.786585,
        -55.857405
      ],
      [
        -34.786105,
        -55.858338
      ]
    ]
  },
  {
    "id": "34002",
    "territorio": "34",
    "coords": [
      [
        -34.784871,
        -55.858655
      ],
      [
        -34.786065,
        -55.858408
      ],
      [
        -34.785929,
        -55.858778
      ],
      [
        -34.78581,
        -55.859433
      ],
      [
        -34.785823,
        -55.859953
      ],
      [
        -34.785946,
        -55.860715
      ],
      [
        -34.785034,
        -55.860967
      ],
      [
        -34.784814,
        -55.859814
      ]
    ]
  },
  {
    "id": "34004",
    "territorio": "34",
    "coords": [
      [
        -34.785854,
        -55.859551
      ],
      [
        -34.78677,
        -55.859433
      ],
      [
        -34.786889,
        -55.859277
      ],
      [
        -34.787506,
        -55.858038
      ],
      [
        -34.786528,
        -55.857657
      ],
      [
        -34.786118,
        -55.85843
      ],
      [
        -34.785968,
        -55.858864
      ]
    ]
  },
  {
    "id": "34003",
    "territorio": "34",
    "coords": [
      [
        -34.786017,
        -55.860683
      ],
      [
        -34.785893,
        -55.860007
      ],
      [
        -34.785876,
        -55.859615
      ],
      [
        -34.786735,
        -55.859513
      ],
      [
        -34.786902,
        -55.859401
      ],
      [
        -34.787572,
        -55.85807
      ],
      [
        -34.787986,
        -55.858344
      ],
      [
        -34.788462,
        -55.858955
      ],
      [
        -34.788026,
        -55.859889
      ],
      [
        -34.787911,
        -55.860189
      ]
    ]
  },
  {
    "id": "34005",
    "territorio": "34",
    "coords": [
      [
        -34.786572,
        -55.857587
      ],
      [
        -34.786911,
        -55.856751
      ],
      [
        -34.78733,
        -55.856724
      ],
      [
        -34.787656,
        -55.856788
      ],
      [
        -34.787982,
        -55.857003
      ],
      [
        -34.788999,
        -55.857829
      ],
      [
        -34.788501,
        -55.858902
      ],
      [
        -34.788004,
        -55.858258
      ],
      [
        -34.787581,
        -55.858017
      ]
    ]
  },
  {
    "id": "37006",
    "territorio": "37",
    "coords": [
      [
        -34.784087,
        -55.854744
      ],
      [
        -34.785497,
        -55.853999
      ],
      [
        -34.785673,
        -55.853924
      ],
      [
        -34.786347,
        -55.853795
      ],
      [
        -34.786867,
        -55.853773
      ],
      [
        -34.786986,
        -55.854814
      ],
      [
        -34.785995,
        -55.854948
      ],
      [
        -34.785417,
        -55.855163
      ],
      [
        -34.784743,
        -55.855646
      ],
      [
        -34.784135,
        -55.855243
      ],
      [
        -34.784091,
        -55.855018
      ]
    ]
  },
  {
    "id": "37005",
    "territorio": "37",
    "coords": [
      [
        -34.784814,
        -55.855688
      ],
      [
        -34.785321,
        -55.855318
      ],
      [
        -34.785721,
        -55.855104
      ],
      [
        -34.786074,
        -55.855007
      ],
      [
        -34.78699,
        -55.854889
      ],
      [
        -34.787017,
        -55.855216
      ],
      [
        -34.786915,
        -55.856311
      ],
      [
        -34.786444,
        -55.856338
      ],
      [
        -34.786069,
        -55.856193
      ],
      [
        -34.785536,
        -55.856032
      ],
      [
        -34.785025,
        -55.855823
      ]
    ]
  },
  {
    "id": "37004",
    "territorio": "37",
    "coords": [
      [
        -34.786986,
        -55.856295
      ],
      [
        -34.787065,
        -55.855168
      ],
      [
        -34.787885,
        -55.855286
      ],
      [
        -34.78888,
        -55.855163
      ],
      [
        -34.78877,
        -55.855495
      ],
      [
        -34.788523,
        -55.855887
      ],
      [
        -34.788427,
        -55.856085
      ],
      [
        -34.788308,
        -55.856547
      ],
      [
        -34.787744,
        -55.856327
      ],
      [
        -34.787519,
        -55.856262
      ],
      [
        -34.787136,
        -55.856246
      ]
    ]
  },
  {
    "id": "37001",
    "territorio": "37",
    "coords": [
      [
        -34.787065,
        -55.855088
      ],
      [
        -34.787017,
        -55.854648
      ],
      [
        -34.786937,
        -55.853763
      ],
      [
        -34.78766,
        -55.853725
      ],
      [
        -34.7877,
        -55.85417
      ],
      [
        -34.787757,
        -55.854337
      ],
      [
        -34.787876,
        -55.854401
      ],
      [
        -34.788043,
        -55.854428
      ],
      [
        -34.788189,
        -55.854374
      ],
      [
        -34.788233,
        -55.854267
      ],
      [
        -34.788136,
        -55.853714
      ],
      [
        -34.788876,
        -55.853376
      ],
      [
        -34.788986,
        -55.853891
      ],
      [
        -34.788982,
        -55.854589
      ],
      [
        -34.788898,
        -55.855104
      ],
      [
        -34.78796,
        -55.855227
      ],
      [
        -34.787352,
        -55.855157
      ]
    ]
  },
  {
    "id": "37003",
    "territorio": "37",
    "coords": [
      [
        -34.788356,
        -55.85659
      ],
      [
        -34.788497,
        -55.85608
      ],
      [
        -34.788924,
        -55.855318
      ],
      [
        -34.789039,
        -55.85468
      ],
      [
        -34.789034,
        -55.853693
      ],
      [
        -34.788946,
        -55.853366
      ],
      [
        -34.789951,
        -55.852867
      ],
      [
        -34.790092,
        -55.85343
      ],
      [
        -34.790127,
        -55.854809
      ],
      [
        -34.79014,
        -55.854964
      ],
      [
        -34.789867,
        -55.855994
      ],
      [
        -34.789299,
        -55.857266
      ],
      [
        -34.789158,
        -55.857239
      ]
    ]
  },
  {
    "id": "37002",
    "territorio": "37",
    "coords": [
      [
        -34.78992,
        -55.852797
      ],
      [
        -34.789726,
        -55.852277
      ],
      [
        -34.789233,
        -55.852389
      ],
      [
        -34.788563,
        -55.852695
      ],
      [
        -34.787669,
        -55.853215
      ],
      [
        -34.786893,
        -55.853521
      ],
      [
        -34.78692,
        -55.853709
      ],
      [
        -34.787281,
        -55.853655
      ],
      [
        -34.787704,
        -55.853661
      ],
      [
        -34.78814,
        -55.853629
      ],
      [
        -34.788757,
        -55.85336
      ],
      [
        -34.789277,
        -55.853124
      ]
    ]
  },
  {
    "id": "38001",
    "territorio": "38",
    "coords": [
      [
        -34.788043,
        -55.860125
      ],
      [
        -34.789603,
        -55.859706
      ],
      [
        -34.789612,
        -55.859395
      ],
      [
        -34.790325,
        -55.857925
      ],
      [
        -34.789841,
        -55.857453
      ],
      [
        -34.789356,
        -55.857346
      ]
    ]
  },
  {
    "id": "38002",
    "territorio": "38",
    "coords": [
      [
        -34.789453,
        -55.857174
      ],
      [
        -34.789938,
        -55.855994
      ],
      [
        -34.790202,
        -55.85505
      ],
      [
        -34.791224,
        -55.85578
      ],
      [
        -34.790396,
        -55.85784
      ],
      [
        -34.789911,
        -55.857335
      ]
    ]
  },
  {
    "id": "38003",
    "territorio": "38",
    "coords": [
      [
        -34.790255,
        -55.853902
      ],
      [
        -34.790916,
        -55.853709
      ],
      [
        -34.791559,
        -55.854932
      ],
      [
        -34.791295,
        -55.855619
      ],
      [
        -34.790317,
        -55.854932
      ],
      [
        -34.790255,
        -55.854707
      ]
    ]
  },
  {
    "id": "38004",
    "territorio": "38",
    "coords": [
      [
        -34.790502,
        -55.857915
      ],
      [
        -34.79133,
        -55.855844
      ],
      [
        -34.791762,
        -55.856305
      ],
      [
        -34.791964,
        -55.856638
      ],
      [
        -34.791594,
        -55.857807
      ],
      [
        -34.791347,
        -55.858848
      ],
      [
        -34.791021,
        -55.858623
      ]
    ]
  },
  {
    "id": "38006",
    "territorio": "38",
    "coords": [
      [
        -34.789726,
        -55.859696
      ],
      [
        -34.7897,
        -55.85947
      ],
      [
        -34.790422,
        -55.85799
      ],
      [
        -34.790836,
        -55.858612
      ],
      [
        -34.79133,
        -55.858977
      ],
      [
        -34.791497,
        -55.859213
      ]
    ]
  },
  {
    "id": "38005",
    "territorio": "38",
    "coords": [
      [
        -34.791691,
        -55.859181
      ],
      [
        -34.791532,
        -55.858945
      ],
      [
        -34.791717,
        -55.857872
      ],
      [
        -34.792079,
        -55.856863
      ],
      [
        -34.792449,
        -55.857496
      ],
      [
        -34.792898,
        -55.858033
      ],
      [
        -34.793303,
        -55.858451
      ],
      [
        -34.793383,
        -55.85873
      ]
    ]
  },
  {
    "id": "1001",
    "territorio": "1",
    "coords": [
      [
        -34.776262,
        -55.848795
      ],
      [
        -34.776112,
        -55.848055
      ],
      [
        -34.773486,
        -55.848763
      ],
      [
        -34.773644,
        -55.849482
      ]
    ]
  },
  {
    "id": "1002",
    "territorio": "1",
    "coords": [
      [
        -34.773468,
        -55.848634
      ],
      [
        -34.776086,
        -55.847958
      ],
      [
        -34.775962,
        -55.847239
      ],
      [
        -34.773336,
        -55.84798
      ]
    ]
  },
  {
    "id": "1003",
    "territorio": "1",
    "coords": [
      [
        -34.773287,
        -55.847872
      ],
      [
        -34.773173,
        -55.847116
      ],
      [
        -34.775856,
        -55.846381
      ],
      [
        -34.775975,
        -55.847154
      ]
    ]
  },
  {
    "id": "1004",
    "territorio": "1",
    "coords": [
      [
        -34.77316,
        -55.847036
      ],
      [
        -34.773023,
        -55.84629
      ],
      [
        -34.775702,
        -55.845571
      ],
      [
        -34.775826,
        -55.846317
      ]
    ]
  },
  {
    "id": "1005",
    "territorio": "1",
    "coords": [
      [
        -34.773014,
        -55.846204
      ],
      [
        -34.772882,
        -55.845464
      ],
      [
        -34.773763,
        -55.845233
      ],
      [
        -34.77386,
        -55.84541
      ],
      [
        -34.774041,
        -55.845544
      ],
      [
        -34.774248,
        -55.84556
      ],
      [
        -34.774301,
        -55.845872
      ]
    ]
  },
  {
    "id": "1006",
    "territorio": "1",
    "coords": [
      [
        -34.774367,
        -55.84585
      ],
      [
        -34.77431,
        -55.845555
      ],
      [
        -34.774495,
        -55.845469
      ],
      [
        -34.774645,
        -55.845239
      ],
      [
        -34.774671,
        -55.844997
      ],
      [
        -34.775544,
        -55.844756
      ],
      [
        -34.77568,
        -55.845496
      ]
    ]
  },
  {
    "id": "2001",
    "territorio": "2",
    "coords": [
      [
        -34.772834,
        -55.845244
      ],
      [
        -34.773733,
        -55.845024
      ],
      [
        -34.77375,
        -55.844809
      ],
      [
        -34.773882,
        -55.844563
      ],
      [
        -34.774059,
        -55.844434
      ],
      [
        -34.774015,
        -55.844139
      ],
      [
        -34.772701,
        -55.844493
      ]
    ]
  },
  {
    "id": "2002",
    "territorio": "2",
    "coords": [
      [
        -34.774125,
        -55.844429
      ],
      [
        -34.774067,
        -55.844133
      ],
      [
        -34.775385,
        -55.843779
      ],
      [
        -34.775504,
        -55.844514
      ],
      [
        -34.774623,
        -55.84475
      ],
      [
        -34.774539,
        -55.844573
      ],
      [
        -34.77442,
        -55.844471
      ],
      [
        -34.774266,
        -55.844412
      ]
    ]
  },
  {
    "id": "2003",
    "territorio": "2",
    "coords": [
      [
        -34.772693,
        -55.844429
      ],
      [
        -34.775372,
        -55.843726
      ],
      [
        -34.775231,
        -55.842959
      ],
      [
        -34.772552,
        -55.843678
      ]
    ]
  },
  {
    "id": "2004",
    "territorio": "2",
    "coords": [
      [
        -34.772543,
        -55.843602
      ],
      [
        -34.775231,
        -55.842889
      ],
      [
        -34.775076,
        -55.8421
      ],
      [
        -34.772406,
        -55.842851
      ]
    ]
  },
  {
    "id": "2005",
    "territorio": "2",
    "coords": [
      [
        -34.772397,
        -55.842782
      ],
      [
        -34.775068,
        -55.842041
      ],
      [
        -34.774913,
        -55.841247
      ],
      [
        -34.772248,
        -55.841998
      ]
    ]
  },
  {
    "id": "2006",
    "territorio": "2",
    "coords": [
      [
        -34.772239,
        -55.841934
      ],
      [
        -34.77208,
        -55.841017
      ],
      [
        -34.77453,
        -55.840384
      ],
      [
        -34.774658,
        -55.840555
      ],
      [
        -34.774772,
        -55.840711
      ],
      [
        -34.774825,
        -55.840829
      ],
      [
        -34.774891,
        -55.841188
      ]
    ]
  },
  {
    "id": "3005",
    "territorio": "5",
    "coords": [
      [
        -34.771199,
        -55.841247
      ],
      [
        -34.771992,
        -55.841038
      ],
      [
        -34.772142,
        -55.841945
      ],
      [
        -34.771899,
        -55.84195
      ],
      [
        -34.771556,
        -55.841838
      ],
      [
        -34.771331,
        -55.841569
      ],
      [
        -34.77123,
        -55.841387
      ]
    ]
  },
  {
    "id": "3004",
    "territorio": "3",
    "coords": [
      [
        -34.771203,
        -55.842556
      ],
      [
        -34.771543,
        -55.841886
      ],
      [
        -34.771763,
        -55.841988
      ],
      [
        -34.772005,
        -55.842025
      ],
      [
        -34.772146,
        -55.841988
      ],
      [
        -34.772296,
        -55.842798
      ],
      [
        -34.771983,
        -55.842803
      ],
      [
        -34.771556,
        -55.842744
      ]
    ]
  },
  {
    "id": "3006",
    "territorio": "3",
    "coords": [
      [
        -34.770573,
        -55.841424
      ],
      [
        -34.771142,
        -55.841269
      ],
      [
        -34.771181,
        -55.841435
      ],
      [
        -34.771331,
        -55.841687
      ],
      [
        -34.771481,
        -55.841854
      ],
      [
        -34.771142,
        -55.842513
      ],
      [
        -34.770749,
        -55.84202
      ],
      [
        -34.770626,
        -55.841757
      ]
    ]
  },
  {
    "id": "3003",
    "territorio": "3",
    "coords": [
      [
        -34.772446,
        -55.843613
      ],
      [
        -34.772318,
        -55.842857
      ],
      [
        -34.771882,
        -55.842878
      ],
      [
        -34.771529,
        -55.842825
      ],
      [
        -34.771159,
        -55.84261
      ],
      [
        -34.770837,
        -55.843254
      ],
      [
        -34.771106,
        -55.843436
      ],
      [
        -34.77156,
        -55.843613
      ],
      [
        -34.771952,
        -55.843672
      ]
    ]
  },
  {
    "id": "3002",
    "territorio": "3",
    "coords": [
      [
        -34.770807,
        -55.843329
      ],
      [
        -34.771106,
        -55.843506
      ],
      [
        -34.771573,
        -55.84371
      ],
      [
        -34.771966,
        -55.843737
      ],
      [
        -34.77245,
        -55.843694
      ],
      [
        -34.772587,
        -55.844445
      ],
      [
        -34.772049,
        -55.844498
      ],
      [
        -34.771516,
        -55.844455
      ],
      [
        -34.770983,
        -55.8443
      ],
      [
        -34.770476,
        -55.843983
      ]
    ]
  },
  {
    "id": "3001",
    "territorio": "3",
    "coords": [
      [
        -34.770454,
        -55.844042
      ],
      [
        -34.770322,
        -55.844316
      ],
      [
        -34.770419,
        -55.844461
      ],
      [
        -34.770494,
        -55.844648
      ],
      [
        -34.770485,
        -55.844933
      ],
      [
        -34.770899,
        -55.845115
      ],
      [
        -34.771362,
        -55.845271
      ],
      [
        -34.771904,
        -55.84534
      ],
      [
        -34.772534,
        -55.845314
      ],
      [
        -34.772737,
        -55.845265
      ],
      [
        -34.7726,
        -55.844504
      ],
      [
        -34.772071,
        -55.844568
      ],
      [
        -34.771543,
        -55.844536
      ],
      [
        -34.770956,
        -55.84437
      ]
    ]
  },
  {
    "id": "3007",
    "territorio": "3",
    "coords": [
      [
        -34.770503,
        -55.841441
      ],
      [
        -34.769877,
        -55.841601
      ],
      [
        -34.770035,
        -55.842251
      ],
      [
        -34.770362,
        -55.842814
      ],
      [
        -34.77078,
        -55.843238
      ],
      [
        -34.771115,
        -55.842562
      ],
      [
        -34.770776,
        -55.842208
      ],
      [
        -34.770591,
        -55.841832
      ]
    ]
  },
  {
    "id": "3008",
    "territorio": "3",
    "coords": [
      [
        -34.770423,
        -55.843946
      ],
      [
        -34.770745,
        -55.843291
      ],
      [
        -34.770419,
        -55.842991
      ],
      [
        -34.770163,
        -55.842621
      ],
      [
        -34.769947,
        -55.842165
      ],
      [
        -34.769811,
        -55.841628
      ],
      [
        -34.769176,
        -55.841795
      ],
      [
        -34.769264,
        -55.842186
      ],
      [
        -34.769383,
        -55.842524
      ],
      [
        -34.769652,
        -55.84305
      ],
      [
        -34.770062,
        -55.843608
      ]
    ]
  },
  {
    "id": "3009",
    "territorio": "3",
    "coords": [
      [
        -34.770401,
        -55.84401
      ],
      [
        -34.770278,
        -55.844289
      ],
      [
        -34.77004,
        -55.844193
      ],
      [
        -34.769846,
        -55.844219
      ],
      [
        -34.769679,
        -55.844353
      ],
      [
        -34.769405,
        -55.844021
      ],
      [
        -34.769013,
        -55.843441
      ],
      [
        -34.768762,
        -55.842905
      ],
      [
        -34.76863,
        -55.842476
      ],
      [
        -34.768511,
        -55.841966
      ],
      [
        -34.769128,
        -55.841811
      ],
      [
        -34.769194,
        -55.842234
      ],
      [
        -34.769326,
        -55.842578
      ],
      [
        -34.769657,
        -55.843152
      ],
      [
        -34.770027,
        -55.843672
      ]
    ]
  },
  {
    "id": "4001",
    "territorio": "4",
    "coords": [
      [
        -34.771379,
        -55.845571
      ],
      [
        -34.77197,
        -55.845619
      ],
      [
        -34.772481,
        -55.845582
      ],
      [
        -34.772798,
        -55.845518
      ],
      [
        -34.772917,
        -55.84622
      ],
      [
        -34.771278,
        -55.84629
      ]
    ]
  },
  {
    "id": "4002",
    "territorio": "4",
    "coords": [
      [
        -34.771261,
        -55.84636
      ],
      [
        -34.772917,
        -55.846301
      ],
      [
        -34.77305,
        -55.847062
      ],
      [
        -34.771137,
        -55.847121
      ]
    ]
  },
  {
    "id": "4003",
    "territorio": "4",
    "coords": [
      [
        -34.771128,
        -55.847191
      ],
      [
        -34.773072,
        -55.847116
      ],
      [
        -34.773195,
        -55.84791
      ],
      [
        -34.771023,
        -55.847964
      ]
    ]
  },
  {
    "id": "4004",
    "territorio": "4",
    "coords": [
      [
        -34.771009,
        -55.848023
      ],
      [
        -34.770895,
        -55.848774
      ],
      [
        -34.773362,
        -55.848693
      ],
      [
        -34.773221,
        -55.847964
      ]
    ]
  },
  {
    "id": "4005",
    "territorio": "4",
    "coords": [
      [
        -34.770899,
        -55.848833
      ],
      [
        -34.770679,
        -55.850276
      ],
      [
        -34.773508,
        -55.849541
      ],
      [
        -34.773362,
        -55.848768
      ]
    ]
  },
  {
    "id": "51001",
    "territorio": "51",
    "coords": [
      [
        -34.770362,
        -55.84519
      ],
      [
        -34.771313,
        -55.845566
      ],
      [
        -34.771203,
        -55.846274
      ],
      [
        -34.76967,
        -55.845544
      ],
      [
        -34.769798,
        -55.845292
      ],
      [
        -34.769934,
        -55.845346
      ],
      [
        -34.770124,
        -55.84534
      ],
      [
        -34.770269,
        -55.845287
      ]
    ]
  },
  {
    "id": "51002",
    "territorio": "51",
    "coords": [
      [
        -34.769304,
        -55.846247
      ],
      [
        -34.769643,
        -55.845593
      ],
      [
        -34.771194,
        -55.846354
      ],
      [
        -34.771071,
        -55.847105
      ]
    ]
  },
  {
    "id": "51003",
    "territorio": "51",
    "coords": [
      [
        -34.768938,
        -55.846961
      ],
      [
        -34.769273,
        -55.846285
      ],
      [
        -34.769445,
        -55.846403
      ],
      [
        -34.771062,
        -55.847175
      ],
      [
        -34.770956,
        -55.847932
      ]
    ]
  },
  {
    "id": "51004",
    "territorio": "51",
    "coords": [
      [
        -34.76855,
        -55.84769
      ],
      [
        -34.768903,
        -55.846998
      ],
      [
        -34.770943,
        -55.848023
      ],
      [
        -34.770851,
        -55.848779
      ]
    ]
  },
  {
    "id": "51005",
    "territorio": "51",
    "coords": [
      [
        -34.768154,
        -55.848377
      ],
      [
        -34.768515,
        -55.847738
      ],
      [
        -34.770824,
        -55.848843
      ],
      [
        -34.770714,
        -55.849584
      ]
    ]
  },
  {
    "id": "51006",
    "territorio": "51",
    "coords": [
      [
        -34.767779,
        -55.849085
      ],
      [
        -34.76811,
        -55.848436
      ],
      [
        -34.77071,
        -55.849659
      ],
      [
        -34.770613,
        -55.850292
      ],
      [
        -34.770331,
        -55.850372
      ],
      [
        -34.770251,
        -55.850276
      ]
    ]
  },
  {
    "id": "51007",
    "territorio": "51",
    "coords": [
      [
        -34.770251,
        -55.850378
      ],
      [
        -34.770084,
        -55.850249
      ],
      [
        -34.767748,
        -55.849138
      ],
      [
        -34.767418,
        -55.849788
      ],
      [
        -34.769137,
        -55.850678
      ]
    ]
  },
  {
    "id": "51008",
    "territorio": "51",
    "coords": [
      [
        -34.767048,
        -55.85049
      ],
      [
        -34.767387,
        -55.849841
      ],
      [
        -34.769044,
        -55.850705
      ],
      [
        -34.767964,
        -55.850984
      ],
      [
        -34.767929,
        -55.850909
      ]
    ]
  },
  {
    "id": "5009",
    "territorio": "5",
    "coords": [
      [
        -34.766682,
        -55.850362
      ],
      [
        -34.765378,
        -55.848817
      ],
      [
        -34.765695,
        -55.850587
      ]
    ]
  },
  {
    "id": "5001",
    "territorio": "5",
    "coords": [
      [
        -34.769599,
        -55.844407
      ],
      [
        -34.769009,
        -55.843624
      ],
      [
        -34.768462,
        -55.844107
      ],
      [
        -34.769573,
        -55.845448
      ],
      [
        -34.769679,
        -55.845233
      ],
      [
        -34.769538,
        -55.844976
      ],
      [
        -34.769502,
        -55.844718
      ]
    ]
  },
  {
    "id": "5002",
    "territorio": "5",
    "coords": [
      [
        -34.76952,
        -55.845534
      ],
      [
        -34.768348,
        -55.844182
      ],
      [
        -34.767889,
        -55.844536
      ],
      [
        -34.769194,
        -55.846124
      ]
    ]
  },
  {
    "id": "5003",
    "territorio": "5",
    "coords": [
      [
        -34.768841,
        -55.846853
      ],
      [
        -34.767299,
        -55.845062
      ],
      [
        -34.76781,
        -55.844622
      ],
      [
        -34.769141,
        -55.846242
      ]
    ]
  },
  {
    "id": "5004",
    "territorio": "5",
    "coords": [
      [
        -34.768462,
        -55.847551
      ],
      [
        -34.768788,
        -55.846971
      ],
      [
        -34.767211,
        -55.845126
      ],
      [
        -34.7667,
        -55.845555
      ]
    ]
  },
  {
    "id": "5005",
    "territorio": "5",
    "coords": [
      [
        -34.768401,
        -55.847658
      ],
      [
        -34.766603,
        -55.845641
      ],
      [
        -34.766162,
        -55.846027
      ],
      [
        -34.76803,
        -55.848259
      ]
    ]
  },
  {
    "id": "5006",
    "territorio": "5",
    "coords": [
      [
        -34.767995,
        -55.848377
      ],
      [
        -34.766039,
        -55.84607
      ],
      [
        -34.76558,
        -55.846478
      ],
      [
        -34.767669,
        -55.848967
      ]
    ]
  },
  {
    "id": "5007",
    "territorio": "5",
    "coords": [
      [
        -34.765007,
        -55.846918
      ],
      [
        -34.765483,
        -55.84651
      ],
      [
        -34.767651,
        -55.849085
      ],
      [
        -34.767343,
        -55.849734
      ],
      [
        -34.765043,
        -55.847143
      ]
    ]
  },
  {
    "id": "5008",
    "territorio": "5",
    "coords": [
      [
        -34.766951,
        -55.850431
      ],
      [
        -34.767299,
        -55.849777
      ],
      [
        -34.765065,
        -55.847266
      ],
      [
        -34.765311,
        -55.848666
      ],
      [
        -34.765422,
        -55.848666
      ]
    ]
  },
  {
    "id": "6001",
    "territorio": "6",
    "coords": [
      [
        -34.768956,
        -55.843506
      ],
      [
        -34.768612,
        -55.842744
      ],
      [
        -34.768427,
        -55.842057
      ],
      [
        -34.767757,
        -55.842218
      ],
      [
        -34.768392,
        -55.84401
      ]
    ]
  },
  {
    "id": "6002",
    "territorio": "6",
    "coords": [
      [
        -34.767828,
        -55.844439
      ],
      [
        -34.768286,
        -55.844064
      ],
      [
        -34.767625,
        -55.842229
      ],
      [
        -34.767043,
        -55.842422
      ]
    ]
  },
  {
    "id": "6003",
    "territorio": "6",
    "coords": [
      [
        -34.767237,
        -55.844954
      ],
      [
        -34.76774,
        -55.844525
      ],
      [
        -34.766938,
        -55.842422
      ],
      [
        -34.766382,
        -55.842583
      ]
    ]
  },
  {
    "id": "6004",
    "territorio": "6",
    "coords": [
      [
        -34.766656,
        -55.845437
      ],
      [
        -34.767149,
        -55.845029
      ],
      [
        -34.766294,
        -55.842605
      ],
      [
        -34.765686,
        -55.842776
      ]
    ]
  },
  {
    "id": "6005",
    "territorio": "6",
    "coords": [
      [
        -34.766083,
        -55.845909
      ],
      [
        -34.766523,
        -55.845523
      ],
      [
        -34.765571,
        -55.842808
      ],
      [
        -34.765016,
        -55.842959
      ]
    ]
  },
  {
    "id": "6006",
    "territorio": "6",
    "coords": [
      [
        -34.764346,
        -55.843141
      ],
      [
        -34.76491,
        -55.842948
      ],
      [
        -34.765977,
        -55.846016
      ],
      [
        -34.76551,
        -55.846403
      ],
      [
        -34.764461,
        -55.843495
      ]
    ]
  },
  {
    "id": "6007",
    "territorio": "6",
    "coords": [
      [
        -34.765413,
        -55.846435
      ],
      [
        -34.76447,
        -55.843849
      ],
      [
        -34.765025,
        -55.846789
      ]
    ]
  },
  {
    "id": "52001",
    "territorio": "52",
    "coords": [
      [
        -34.764311,
        -55.847068
      ],
      [
        -34.764875,
        -55.846907
      ],
      [
        -34.764161,
        -55.843163
      ],
      [
        -34.76365,
        -55.843334
      ]
    ]
  },
  {
    "id": "52002",
    "territorio": "52",
    "coords": [
      [
        -34.763051,
        -55.845405
      ],
      [
        -34.76387,
        -55.84519
      ],
      [
        -34.763536,
        -55.843323
      ],
      [
        -34.762716,
        -55.84357
      ]
    ]
  },
  {
    "id": "52003",
    "territorio": "52",
    "coords": [
      [
        -34.762927,
        -55.845426
      ],
      [
        -34.762566,
        -55.843581
      ],
      [
        -34.760689,
        -55.844064
      ],
      [
        -34.761094,
        -55.845952
      ]
    ]
  },
  {
    "id": "52005",
    "territorio": "52",
    "coords": [
      [
        -34.763879,
        -55.84534
      ],
      [
        -34.76306,
        -55.845534
      ],
      [
        -34.763394,
        -55.847315
      ],
      [
        -34.764223,
        -55.847079
      ]
    ]
  },
  {
    "id": "52004",
    "territorio": "52",
    "coords": [
      [
        -34.762954,
        -55.845577
      ],
      [
        -34.761085,
        -55.846092
      ],
      [
        -34.761297,
        -55.847164
      ],
      [
        -34.761394,
        -55.84798
      ],
      [
        -34.763289,
        -55.847336
      ]
    ]
  },
  {
    "id": "53001",
    "territorio": "53",
    "coords": [
      [
        -34.764355,
        -55.847197
      ],
      [
        -34.764893,
        -55.847036
      ],
      [
        -34.765175,
        -55.848709
      ],
      [
        -34.764637,
        -55.848849
      ]
    ]
  },
  {
    "id": "53002",
    "territorio": "53",
    "coords": [
      [
        -34.76521,
        -55.848827
      ],
      [
        -34.764655,
        -55.848999
      ],
      [
        -34.765157,
        -55.851692
      ],
      [
        -34.765713,
        -55.851552
      ]
    ]
  },
  {
    "id": "53003",
    "territorio": "53",
    "coords": [
      [
        -34.764188,
        -55.851842
      ],
      [
        -34.763976,
        -55.850683
      ],
      [
        -34.764814,
        -55.850437
      ],
      [
        -34.765051,
        -55.851617
      ]
    ]
  },
  {
    "id": "53005",
    "territorio": "53",
    "coords": [
      [
        -34.764796,
        -55.850329
      ],
      [
        -34.764576,
        -55.848978
      ],
      [
        -34.763712,
        -55.849235
      ],
      [
        -34.76395,
        -55.850565
      ]
    ]
  },
  {
    "id": "53008",
    "territorio": "53",
    "coords": [
      [
        -34.763694,
        -55.849106
      ],
      [
        -34.76454,
        -55.84886
      ],
      [
        -34.764258,
        -55.847229
      ],
      [
        -34.763394,
        -55.847443
      ]
    ]
  },
  {
    "id": "53004",
    "territorio": "53",
    "coords": [
      [
        -34.764082,
        -55.851853
      ],
      [
        -34.762742,
        -55.852218
      ],
      [
        -34.762143,
        -55.851467
      ],
      [
        -34.762064,
        -55.851113
      ],
      [
        -34.762557,
        -55.851123
      ],
      [
        -34.762989,
        -55.850909
      ],
      [
        -34.763897,
        -55.850705
      ]
    ]
  },
  {
    "id": "53006",
    "territorio": "53",
    "coords": [
      [
        -34.763844,
        -55.850523
      ],
      [
        -34.763597,
        -55.849235
      ],
      [
        -34.763121,
        -55.849407
      ],
      [
        -34.76291,
        -55.8496
      ],
      [
        -34.762064,
        -55.849686
      ],
      [
        -34.761773,
        -55.849804
      ],
      [
        -34.762037,
        -55.851005
      ],
      [
        -34.76254,
        -55.850962
      ],
      [
        -34.762919,
        -55.850769
      ]
    ]
  },
  {
    "id": "53007",
    "territorio": "53",
    "coords": [
      [
        -34.761773,
        -55.849643
      ],
      [
        -34.762196,
        -55.849546
      ],
      [
        -34.762813,
        -55.849482
      ],
      [
        -34.763157,
        -55.849278
      ],
      [
        -34.763571,
        -55.849138
      ],
      [
        -34.763271,
        -55.847465
      ],
      [
        -34.76142,
        -55.848076
      ],
      [
        -34.761588,
        -55.848945
      ],
      [
        -34.761693,
        -55.849138
      ]
    ]
  },
  {
    "id": "12001",
    "territorio": "12",
    "coords": [
      [
        -34.773662,
        -55.850705
      ],
      [
        -34.773442,
        -55.849718
      ],
      [
        -34.776279,
        -55.848935
      ],
      [
        -34.776808,
        -55.851896
      ],
      [
        -34.776015,
        -55.85211
      ],
      [
        -34.775654,
        -55.850265
      ]
    ]
  },
  {
    "id": "12002",
    "territorio": "12",
    "coords": [
      [
        -34.770586,
        -55.851724
      ],
      [
        -34.770586,
        -55.85151
      ],
      [
        -34.77041,
        -55.850501
      ],
      [
        -34.773345,
        -55.84975
      ],
      [
        -34.773556,
        -55.850759
      ],
      [
        -34.772032,
        -55.851166
      ]
    ]
  },
  {
    "id": "12003",
    "territorio": "12",
    "coords": [
      [
        -34.771582,
        -55.85151
      ],
      [
        -34.772093,
        -55.851284
      ],
      [
        -34.773592,
        -55.850834
      ],
      [
        -34.775592,
        -55.850437
      ],
      [
        -34.775777,
        -55.851434
      ],
      [
        -34.773221,
        -55.852132
      ],
      [
        -34.772798,
        -55.851885
      ]
    ]
  },
  {
    "id": "12004",
    "territorio": "12",
    "coords": [
      [
        -34.769811,
        -55.853655
      ],
      [
        -34.77056,
        -55.851864
      ],
      [
        -34.771397,
        -55.851595
      ],
      [
        -34.77271,
        -55.851982
      ],
      [
        -34.773072,
        -55.852196
      ],
      [
        -34.772102,
        -55.852443
      ]
    ]
  },
  {
    "id": "13001",
    "territorio": "13",
    "coords": [
      [
        -34.768489,
        -55.851016
      ],
      [
        -34.770269,
        -55.850555
      ],
      [
        -34.770436,
        -55.851552
      ],
      [
        -34.770401,
        -55.851799
      ],
      [
        -34.769775,
        -55.852057
      ],
      [
        -34.768674,
        -55.852078
      ]
    ]
  },
  {
    "id": "13002",
    "territorio": "13",
    "coords": [
      [
        -34.768683,
        -55.852196
      ],
      [
        -34.769634,
        -55.852185
      ],
      [
        -34.770348,
        -55.851949
      ],
      [
        -34.769643,
        -55.853688
      ],
      [
        -34.768912,
        -55.85343
      ],
      [
        -34.768868,
        -55.853173
      ]
    ]
  },
  {
    "id": "13003",
    "territorio": "13",
    "coords": [
      [
        -34.766656,
        -55.851499
      ],
      [
        -34.768365,
        -55.851027
      ],
      [
        -34.76855,
        -55.852121
      ],
      [
        -34.767616,
        -55.852282
      ],
      [
        -34.766841,
        -55.852475
      ]
    ]
  },
  {
    "id": "13004",
    "territorio": "13",
    "coords": [
      [
        -34.766849,
        -55.852604
      ],
      [
        -34.767854,
        -55.852336
      ],
      [
        -34.768577,
        -55.852228
      ],
      [
        -34.768806,
        -55.853441
      ],
      [
        -34.767995,
        -55.853451
      ],
      [
        -34.767008,
        -55.85358
      ]
    ]
  },
  {
    "id": "73001",
    "territorio": "73",
    "coords": [
      [
        -34.762848,
        -55.852518
      ],
      [
        -34.766559,
        -55.851531
      ],
      [
        -34.766717,
        -55.852518
      ],
      [
        -34.764523,
        -55.853409
      ],
      [
        -34.764082,
        -55.853484
      ],
      [
        -34.763015,
        -55.853516
      ]
    ]
  },
  {
    "id": "73003",
    "territorio": "73",
    "coords": [
      [
        -34.763553,
        -55.854396
      ],
      [
        -34.764549,
        -55.85357
      ],
      [
        -34.765845,
        -55.852958
      ],
      [
        -34.766374,
        -55.852722
      ],
      [
        -34.766744,
        -55.852647
      ],
      [
        -34.766894,
        -55.853602
      ],
      [
        -34.765607,
        -55.854149
      ],
      [
        -34.765166,
        -55.854342
      ],
      [
        -34.764232,
        -55.85505
      ],
      [
        -34.764082,
        -55.85505
      ]
    ]
  },
  {
    "id": "73002",
    "territorio": "73",
    "coords": [
      [
        -34.763086,
        -55.853623
      ],
      [
        -34.764073,
        -55.853623
      ],
      [
        -34.764382,
        -55.853548
      ],
      [
        -34.7635,
        -55.854299
      ]
    ]
  },
  {
    "id": "75003",
    "territorio": "75",
    "coords": [
      [
        -34.759437,
        -55.853451
      ],
      [
        -34.762769,
        -55.85254
      ],
      [
        -34.76291,
        -55.853527
      ],
      [
        -34.762716,
        -55.853688
      ],
      [
        -34.761165,
        -55.854181
      ],
      [
        -34.759631,
        -55.854503
      ]
    ]
  },
  {
    "id": "75002",
    "territorio": "75",
    "coords": [
      [
        -34.762963,
        -55.853623
      ],
      [
        -34.763386,
        -55.854374
      ],
      [
        -34.762945,
        -55.854825
      ],
      [
        -34.761222,
        -55.854272
      ],
      [
        -34.76261,
        -55.853859
      ]
    ]
  },
  {
    "id": "75001",
    "territorio": "75",
    "coords": [
      [
        -34.764117,
        -55.85519
      ],
      [
        -34.76395,
        -55.855093
      ],
      [
        -34.763465,
        -55.854481
      ],
      [
        -34.763104,
        -55.854868
      ],
      [
        -34.762936,
        -55.854964
      ],
      [
        -34.761138,
        -55.854331
      ],
      [
        -34.760715,
        -55.85519
      ],
      [
        -34.761544,
        -55.855479
      ],
      [
        -34.762363,
        -55.855812
      ],
      [
        -34.762822,
        -55.856069
      ],
      [
        -34.763284,
        -55.856343
      ],
      [
        -34.763337,
        -55.856354
      ],
      [
        -34.763562,
        -55.855967
      ]
    ]
  },
  {
    "id": "77003",
    "territorio": "77",
    "coords": [
      [
        -34.760702,
        -55.855249
      ],
      [
        -34.760133,
        -55.856279
      ],
      [
        -34.760407,
        -55.85623
      ],
      [
        -34.762037,
        -55.856847
      ],
      [
        -34.762473,
        -55.85711
      ],
      [
        -34.76291,
        -55.857507
      ],
      [
        -34.763033,
        -55.856971
      ],
      [
        -34.763293,
        -55.856413
      ],
      [
        -34.762302,
        -55.855882
      ]
    ]
  },
  {
    "id": "77002",
    "territorio": "77",
    "coords": [
      [
        -34.760107,
        -55.856332
      ],
      [
        -34.75997,
        -55.857207
      ],
      [
        -34.761076,
        -55.857625
      ],
      [
        -34.761627,
        -55.857861
      ],
      [
        -34.762174,
        -55.858135
      ],
      [
        -34.762469,
        -55.858451
      ],
      [
        -34.762738,
        -55.858832
      ],
      [
        -34.762892,
        -55.857577
      ],
      [
        -34.762376,
        -55.857137
      ],
      [
        -34.762002,
        -55.856895
      ],
      [
        -34.760376,
        -55.856295
      ]
    ]
  },
  {
    "id": "77001",
    "territorio": "77",
    "coords": [
      [
        -34.761037,
        -55.857689
      ],
      [
        -34.759957,
        -55.857276
      ],
      [
        -34.759803,
        -55.857893
      ],
      [
        -34.759684,
        -55.858172
      ],
      [
        -34.759507,
        -55.858424
      ],
      [
        -34.759314,
        -55.858617
      ],
      [
        -34.759371,
        -55.858666
      ],
      [
        -34.760499,
        -55.859154
      ],
      [
        -34.761447,
        -55.858929
      ],
      [
        -34.761614,
        -55.859014
      ],
      [
        -34.761759,
        -55.859202
      ],
      [
        -34.761896,
        -55.8599
      ],
      [
        -34.762566,
        -55.85976
      ],
      [
        -34.762623,
        -55.859647
      ],
      [
        -34.762707,
        -55.858891
      ],
      [
        -34.762425,
        -55.858505
      ],
      [
        -34.762116,
        -55.858156
      ]
    ]
  },
  {
    "id": "82001",
    "territorio": "82",
    "coords": [
      [
        -34.759613,
        -55.854616
      ],
      [
        -34.761125,
        -55.854278
      ],
      [
        -34.76008,
        -55.856262
      ],
      [
        -34.759076,
        -55.856059
      ],
      [
        -34.759274,
        -55.855592
      ],
      [
        -34.759472,
        -55.855114
      ]
    ]
  },
  {
    "id": "82002",
    "territorio": "82",
    "coords": [
      [
        -34.758106,
        -55.856187
      ],
      [
        -34.758705,
        -55.856037
      ],
      [
        -34.759005,
        -55.856059
      ],
      [
        -34.759437,
        -55.855034
      ],
      [
        -34.75953,
        -55.854669
      ],
      [
        -34.75785,
        -55.855007
      ]
    ]
  },
  {
    "id": "82005",
    "territorio": "82",
    "coords": [
      [
        -34.756321,
        -55.854262
      ],
      [
        -34.759353,
        -55.853446
      ],
      [
        -34.759552,
        -55.854567
      ],
      [
        -34.759494,
        -55.854621
      ],
      [
        -34.757868,
        -55.854943
      ],
      [
        -34.756489,
        -55.855275
      ]
    ]
  },
  {
    "id": "82004",
    "territorio": "82",
    "coords": [
      [
        -34.756264,
        -55.854294
      ],
      [
        -34.755303,
        -55.854578
      ],
      [
        -34.755836,
        -55.856826
      ],
      [
        -34.756704,
        -55.856574
      ],
      [
        -34.756489,
        -55.855758
      ]
    ]
  },
  {
    "id": "82003",
    "territorio": "82",
    "coords": [
      [
        -34.756511,
        -55.85534
      ],
      [
        -34.757806,
        -55.855013
      ],
      [
        -34.758049,
        -55.856214
      ],
      [
        -34.756762,
        -55.856552
      ],
      [
        -34.756621,
        -55.856026
      ],
      [
        -34.756555,
        -55.855758
      ]
    ]
  },
  {
    "id": "83002",
    "territorio": "83",
    "coords": [
      [
        -34.758467,
        -55.858279
      ],
      [
        -34.758868,
        -55.857421
      ],
      [
        -34.759199,
        -55.856128
      ],
      [
        -34.760067,
        -55.856338
      ],
      [
        -34.759939,
        -55.857185
      ],
      [
        -34.759759,
        -55.857888
      ],
      [
        -34.759644,
        -55.858135
      ],
      [
        -34.75953,
        -55.858328
      ],
      [
        -34.759283,
        -55.858601
      ]
    ]
  },
  {
    "id": "83003",
    "territorio": "83",
    "coords": [
      [
        -34.758124,
        -55.856262
      ],
      [
        -34.758719,
        -55.856107
      ],
      [
        -34.759133,
        -55.856128
      ],
      [
        -34.758842,
        -55.857362
      ],
      [
        -34.75841,
        -55.858258
      ],
      [
        -34.757877,
        -55.858848
      ],
      [
        -34.757449,
        -55.85858
      ],
      [
        -34.757348,
        -55.85844
      ],
      [
        -34.757299,
        -55.858317
      ],
      [
        -34.757291,
        -55.858172
      ],
      [
        -34.757564,
        -55.857823
      ],
      [
        -34.757828,
        -55.857448
      ],
      [
        -34.758027,
        -55.857046
      ],
      [
        -34.758128,
        -55.8566
      ]
    ]
  },
  {
    "id": "83004",
    "territorio": "83",
    "coords": [
      [
        -34.756779,
        -55.856622
      ],
      [
        -34.758053,
        -55.856268
      ],
      [
        -34.758071,
        -55.856568
      ],
      [
        -34.757939,
        -55.857115
      ],
      [
        -34.757427,
        -55.85792
      ],
      [
        -34.757269,
        -55.858097
      ],
      [
        -34.757145,
        -55.857813
      ]
    ]
  },
  {
    "id": "83005",
    "territorio": "83",
    "coords": [
      [
        -34.756709,
        -55.856638
      ],
      [
        -34.755871,
        -55.856863
      ],
      [
        -34.755792,
        -55.857051
      ],
      [
        -34.756876,
        -55.860071
      ],
      [
        -34.757537,
        -55.859722
      ],
      [
        -34.757621,
        -55.859653
      ],
      [
        -34.757701,
        -55.859556
      ],
      [
        -34.757723,
        -55.859486
      ],
      [
        -34.757749,
        -55.859427
      ],
      [
        -34.75778,
        -55.859315
      ],
      [
        -34.757806,
        -55.859122
      ],
      [
        -34.757842,
        -55.858923
      ],
      [
        -34.757414,
        -55.858634
      ],
      [
        -34.757291,
        -55.858473
      ],
      [
        -34.757255,
        -55.85836
      ],
      [
        -34.757238,
        -55.858156
      ],
      [
        -34.757158,
        -55.858011
      ],
      [
        -34.756916,
        -55.857249
      ]
    ]
  },
  {
    "id": "83001",
    "territorio": "83",
    "coords": [
      [
        -34.759217,
        -55.858655
      ],
      [
        -34.758414,
        -55.858333
      ],
      [
        -34.757899,
        -55.858912
      ],
      [
        -34.757753,
        -55.859556
      ],
      [
        -34.757582,
        -55.859776
      ],
      [
        -34.756894,
        -55.860119
      ],
      [
        -34.757273,
        -55.861171
      ],
      [
        -34.758375,
        -55.860822
      ],
      [
        -34.75841,
        -55.860634
      ],
      [
        -34.758983,
        -55.858907
      ],
      [
        -34.759098,
        -55.858752
      ]
    ]
  },
  {
    "id": "84005",
    "territorio": "84",
    "coords": [
      [
        -34.758467,
        -55.860758
      ],
      [
        -34.758556,
        -55.860415
      ],
      [
        -34.759076,
        -55.85888
      ],
      [
        -34.759296,
        -55.858687
      ],
      [
        -34.760001,
        -55.85902
      ],
      [
        -34.759957,
        -55.859234
      ],
      [
        -34.760142,
        -55.860329
      ]
    ]
  },
  {
    "id": "84004",
    "territorio": "84",
    "coords": [
      [
        -34.760243,
        -55.860339
      ],
      [
        -34.760036,
        -55.859197
      ],
      [
        -34.76008,
        -55.859047
      ],
      [
        -34.760473,
        -55.859218
      ],
      [
        -34.761429,
        -55.858993
      ],
      [
        -34.761561,
        -55.859041
      ],
      [
        -34.761711,
        -55.859245
      ],
      [
        -34.761843,
        -55.85991
      ]
    ]
  },
  {
    "id": "84003",
    "territorio": "84",
    "coords": [
      [
        -34.757295,
        -55.861219
      ],
      [
        -34.762037,
        -55.859964
      ],
      [
        -34.762478,
        -55.859867
      ],
      [
        -34.762011,
        -55.860769
      ],
      [
        -34.761852,
        -55.861123
      ],
      [
        -34.757656,
        -55.862217
      ]
    ]
  },
  {
    "id": "84002",
    "territorio": "84",
    "coords": [
      [
        -34.761799,
        -55.861241
      ],
      [
        -34.757692,
        -55.862292
      ],
      [
        -34.757859,
        -55.862786
      ],
      [
        -34.758353,
        -55.86329
      ],
      [
        -34.759296,
        -55.86285
      ],
      [
        -34.759913,
        -55.862764
      ],
      [
        -34.761165,
        -55.862432
      ]
    ]
  },
  {
    "id": "84001",
    "territorio": "84",
    "coords": [
      [
        -34.761931,
        -55.861219
      ],
      [
        -34.762319,
        -55.861112
      ],
      [
        -34.76246,
        -55.86211
      ],
      [
        -34.761314,
        -55.862399
      ]
    ]
  },
  {
    "id": "81002",
    "territorio": "81",
    "coords": [
      [
        -34.762478,
        -55.862206
      ],
      [
        -34.759948,
        -55.862904
      ],
      [
        -34.759296,
        -55.862936
      ],
      [
        -34.758635,
        -55.86329
      ],
      [
        -34.759393,
        -55.86418
      ],
      [
        -34.759622,
        -55.863987
      ],
      [
        -34.760028,
        -55.863869
      ],
      [
        -34.760741,
        -55.863858
      ],
      [
        -34.762363,
        -55.86344
      ],
      [
        -34.762302,
        -55.862979
      ]
    ]
  },
  {
    "id": "81001",
    "territorio": "81",
    "coords": [
      [
        -34.759499,
        -55.864277
      ],
      [
        -34.759604,
        -55.864148
      ],
      [
        -34.760089,
        -55.863955
      ],
      [
        -34.760759,
        -55.863987
      ],
      [
        -34.762663,
        -55.863472
      ],
      [
        -34.762786,
        -55.864352
      ],
      [
        -34.761129,
        -55.864803
      ],
      [
        -34.760503,
        -55.865275
      ]
    ]
  }
]

      // ===== Geolocalizaci√≥n en tiempo real =====
const GEO_MAX_KM = 8; // umbral
const ORIGIN = map.getCenter(); // el territorio se toma desde el centro inicial (al abrir la p√°gina)

let geoWatchId = null;
let userMarker = null;
let accuracyCircle = null;
let geoEnabled = false;


const elGeoStatus = document.getElementById("geo-status");
const elFarBanner = document.getElementById("far-banner");

// üîÅ Delegaci√≥n a nivel documento
document.addEventListener("click", (e) => {
  const btn = e.target.closest && e.target.closest("#btn-geo");
  if (!btn) return;
  if (geoEnabled) stopGeo(); else startGeo();
});


// (Inicial) por si quer√©s que empiece apagado (default):
//stopGeo();
      /*************** UTILIDADES ***************/
      function diferenciaEnMeses(a, b) {
        return (
          (b.getFullYear() - a.getFullYear()) * 12 +
          (b.getMonth() - a.getMonth())
        );
      }
      function quitarTildes(s) {
        return s.normalize?.("NFD").replace(/\p{Diacritic}/gu, "") || s;
      }
      function parseCSVLine(line) {
        const out = [];
        let cur = "",
          inQ = false;
        for (let i = 0; i < line.length; i++) {
          const ch = line[i];
          if (ch === '"') {
            if (inQ && line[i + 1] === '"') {
              cur += '"';
              i++;
            } else {
              inQ = !inQ;
            }
          } else if (ch === "," && !inQ) {
            out.push(cur);
            cur = "";
          } else {
            cur += ch;
          }
        }
        out.push(cur);
        return out;
      }
      function parseFechaSeguro(s) {
        s = String(s || "").trim();
        if (!s) return new Date("Invalid");
        const d1 = new Date(s);
        if (!isNaN(d1)) return d1;
        const m = s.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})$/);
        if (m) return new Date(+m[3], +m[2] - 1, +m[1]);
        return new Date("Invalid");
      }
      function normalizarFinalizado(v) {
        const s = String(v ?? "")
          .trim()
          .toLowerCase();
        if (!s) return "";
        if (
          [
            "si",
            "s√≠",
            "s",
            "true",
            "1",
            "ok",
            "finalizado",
            "completo",
            "terminado",
          ].includes(s)
        )
          return "Si";
        if (["no", "n", "false", "0", "pendiente", "incompleto"].includes(s))
          return "No";
        return s;
      }
      function obtenerColor(fecha, finalizado) {
        // Sin fecha v√°lida => gris
        if (!(fecha instanceof Date) || isNaN(fecha)) return "gray";
      
        const ahora = new Date();
        const diffMeses = diferenciaEnMeses(fecha, ahora);
      
        const fin = String(finalizado ?? "").trim().toLowerCase();
        const esSi =
          ["si","s√≠","true","1","ok","finalizado","completo","terminado"].includes(fin) || finalizado === true;
      
        if (diffMeses < 2 && !esSi) return "blue";
        if (diffMeses < 2 &&  esSi) return "green";
        if (diffMeses <= 3) return "yellow";
        return "red";
      }
      function actualizarContadores() {
        document.getElementById("contador-azul").textContent = contadores.blue;
        document.getElementById("contador-verde").textContent =
          contadores.green;
        document.getElementById("contador-amarillo").textContent =
          contadores.yellow;
        document.getElementById("contador-rojo").textContent = contadores.red;
      }

            // === AUTH CLIENT ===
      const AUTH = {
        get token() { return localStorage.getItem('auth_token') || ''; },
        set token(v){ localStorage.setItem('auth_token', v || ''); },
        get user()  { return localStorage.getItem('auth_user') || ''; },
        set user(v) { localStorage.setItem('auth_user', v || ''); },
        isLoggedIn(){ return !!this.token; },
        logout(){ localStorage.removeItem('auth_token'); localStorage.removeItem('auth_user'); }
      };

      async function login(usuario, password){
        const body = new URLSearchParams();
        body.set('action','login');
        body.set('usuario', usuario.trim().toLowerCase());
        body.set('password', password);
        const res = await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type':'application/x-www-form-urlencoded;charset=utf-8' },
          body
        });
        const data = await res.json().catch(()=>({}));
        if (!res.ok || !data.ok) throw new Error(data.error || 'Login fall√≥');
        AUTH.token = data.token;
        AUTH.user  = data.usuario;
        return data;
      }

      async function requireLoginThen(next){
        if (AUTH.isLoggedIn()) { next(); return; }
        openLoginModal(async ({usuario, password, close}) => {
          try {
            await login(usuario, password);
            close();
            showToast('Sesi√≥n iniciada');
            next();
          } catch(e){
            alert('Error: ' + e.message);
          }
        });
      }

      /*************** FETCH CSV ROBUSTO (con fallbacks CORS) ***************/
      async function fetchTextWithFallback(sheetCsvUrl) {
        // Intento directo (sirve si us√°s Live Server/localhost y Google permite CORS)
        try {
          const res = await fetch(sheetCsvUrl, {
            redirect: "follow",
            headers: { Accept: "text/csv" },
          });
          if (res.ok) {
            const txt = await res.text();
            if (txt && txt.trim() !== "") return txt;
          }
        } catch (_) {}

        // Proxies p√∫blicos (ordenados por confiabilidad percibida)
        const candidates = [
          // AllOrigins
          "https://api.allorigins.win/raw?url=" +
            encodeURIComponent(sheetCsvUrl),
          // cors.isomorphic-git.org
          "https://cors.isomorphic-git.org/" + sheetCsvUrl,
          // r.jina.ai (http/https)
          "https://r.jina.ai/http://" + sheetCsvUrl.replace(/^https?:\/\//, ""),
          "https://r.jina.ai/https://" +
            sheetCsvUrl.replace(/^https?:\/\//, ""),
        ];

        for (const url of candidates) {
          try {
            const res = await fetch(url, { redirect: "follow" });
            if (res.ok) {
              const txt = await res.text();
              if (txt && txt.trim() !== "") return txt;
            }
          } catch (e) {
            console.warn("Proxy fall√≥:", url, e);
          }
        }

        throw new Error(
          "No se pudo obtener el CSV (CORS/proxy). Sugerencia: serv√≠ el HTML en http://localhost y/o crea un WebApp en Apps Script como proxy."
        );
      }

      function indicesPorEncabezado(headers) {
        const norm = headers.map((h) =>
          quitarTildes(
            String(h || "")
              .trim()
              .toLowerCase()
          )
        );
        const lookup = (...aliases) => {
          const aliNorm = aliases.map((a) => quitarTildes(a.toLowerCase()));
          for (let i = 0; i < norm.length; i++)
            if (aliNorm.includes(norm[i])) return i;
          return -1;
        };
        return {
          id: lookup("id", "identificador", "territorio"),
          fecha: lookup(
            "ultima fecha",
            "√∫ltima fecha",
            "fecha",
            "fecha ultima",
            "fecha √∫ltima"
          ),
          finalizado: lookup(
            "finalizado",
            "se finalizo el territorio",
            "se finaliz√≥ el territorio",
            "¬øse finaliz√≥?",
            "se finalizo",
            "se finaliz√≥",
            "estado"
          ),
        };
      }

      async function cargarDatosDesdeSheets() {
        try {
          const csvData = await fetchTextWithFallback(SHEET_CSV); // üîß usa fallbacks CORS
          console.log(csvData);
          const filas = csvData.split(/\r?\n/).filter((l) => l.trim() !== "");
          if (filas.length === 0) return [];
          const headerCols = parseCSVLine(filas[0]);
          let start = 0;
          let idxId = 0,
            idxFecha = 1,
            idxFin = 2;

          const joined = headerCols.join(",").toLowerCase();
          const looksHeader = /id|fecha|finaliz/.test(joined);
          if (looksHeader) {
            const { id, fecha, finalizado } = indicesPorEncabezado(headerCols);
            if (id !== -1) idxId = id;
            if (fecha !== -1) idxFecha = fecha;
            if (finalizado !== -1) idxFin = finalizado;
            start = 1;
          }

          const datos = [];
          for (let i = start; i < filas.length; i++) {
            const cols = parseCSVLine(filas[i]);
            const idStr = (cols[idxId] ?? "").trim();
            const fechaStr = (cols[idxFecha] ?? "").trim();
            const finStr = (cols[idxFin] ?? "").trim();

            // üîß Guardamos id tambi√©n como string para comparar con poligonos
            const id = (/^\d+$/.test(idStr) ? parseInt(idStr, 10) : idStr); // conserva no num√©ricos
            const fecha = parseFechaSeguro(fechaStr);
            const finalizado = normalizarFinalizado(finStr);

            if (idStr !== "" && fecha instanceof Date && !isNaN(fecha)) {
              datos.push({ id, fecha, finalizado });
            }
          }
          return datos;
        } catch (error) {
          console.error("Error cargando datos desde Google Sheets:", error);
          return [];
        }
      }

      /*************** UI: panel info ***************/
      const infoPanel = document.getElementById("info-panel");
      const polygonId = document.getElementById("polygon-id");
      const polygonFecha = document.getElementById("polygon-fecha");
      const layerById = new Map();
      const dataById  = new Map();
      function idKey(x){ return normalizarId(x); }
      const READ_CSV_URL = (typeof SHEET_CSV !== "undefined" && SHEET_CSV) ? SHEET_CSV : "";
      const WEBHOOK_URL = "https://script.google.com/macros/s/AKfycbz3t0e03wMw6uJ-IsIIHmnvizMBRxeBF2Y7Et2uiTL-5d8L7di8uFA3HWkdw0xMLj0/exec";
  
  
      function parseFecha(s){
        if(!s) return null;
        const t = String(s).trim();
        const d1 = new Date(t); if(!isNaN(d1)) return d1;
        const m = t.match(/^([0-3]?\d)[\/\-]([0-1]?\d)[\/\-](\d{4})$/);
        if(m){ const [_,dd,mm,yy]=m; return new Date(parseInt(yy), parseInt(mm)-1, parseInt(dd)); }
        const m2 = t.match(/^(\d{4})[\/\-]([0-1]?\d)[\/\-]([0-3]?\d)$/);
        if(m2){ const [_,yy,mm,dd]=m2; return new Date(parseInt(yy), parseInt(mm)-1, parseInt(dd)); }
        return null;
      }
    function normalizarFinalizado(v){
      const s = String(v ?? '').trim().toLowerCase();
      if(!s) return '';
      if(['si','s√≠','s','true','1','ok','finalizado','completo','terminado'].includes(s)) return 'Si';
      if(['no','n','false','0','pendiente','incompleto','en curso','trabajando'].includes(s)) return 'No';
      return s;
    }

    function estiloPorKey(key){
      const base = { color:'#333', weight:1, fillOpacity:0.35 };
      if(key==='blue')   return { ...base, fillColor:'#3388ff' };
      if(key==='green')  return { ...base, fillColor:'#2e7d32' };
      if(key==='yellow') return { ...base, fillColor:'#ffd500' };
      if(key==='red')    return { ...base, fillColor:'#b53a22' };
      if(key==='gray')   return { ...base, fillColor:'#9e9e9e' }; // ‚Üê NUEVO
      return { ...base, fillColor:'#90caf9' };
    }
      /*************** CARGA DEL MAPA ***************/
      async function cargarMapa() {
        const datosSheets = await cargarDatosDesdeSheets();

        contadores = { blue: 0, green: 0, yellow: 0, red: 0 };

        poligonos.forEach((p) => {
          // üîß match por string para evitar "32" vs 32
          const dato = datosSheets.find((d) => normalizarId(d.id) === normalizarId(p.id));
          p.fecha = dato ? dato.fecha : null;
          p.finalizado = dato ? dato.finalizado : "";

          const colorInicial = obtenerColor(p.fecha, p.finalizado);
          if (contadores[colorInicial] != null) contadores[colorInicial]++;

          const poly = L.polygon(p.coords, {
            color: "black",
            fillColor: colorInicial,
            fillOpacity: 0.5,
          }).addTo(map);

          const tooltipContent = `
          <div class="tooltip-content">
            <div><strong>${p.id}</strong></div>
          </div>
        `;
          poly.bindTooltip(tooltipContent, {
            permanent: true,
            direction: "center",
            className: "label",
          });

          poly.on("click", function () {
            abrirForm(p);
            /*infoPanel.style.display = "block";
            polygonId.textContent = p.id;
            polygonFecha.textContent =
              (p.fecha instanceof Date && !isNaN(p.fecha))
                ? p.fecha.toLocaleDateString()
                : "No hay datos";*/

          });
        });

        actualizarContadores();
      }

      function repintarContadores(){
        const ids = { blue:'contador-azul', green:'contador-verde', yellow:'contador-amarillo', red:'contador-rojo' };
        for(const k of Object.keys(ids)){
          const el = document.getElementById(ids[k]);
          if(el) el.textContent = String(contadores[k]||0);
        }
      }

      function abrirForm(p){
        console.log("abrirForm");
        const textContent =
              (p.fecha instanceof Date && !isNaN(p.fecha))
                ? p.fecha.toLocaleDateString()
                : "No hay datos";
        const titulo = `Registrar territorio ${p.territorio || p.id} - √öltima visita: ${textContent}`;
        showModal(formHTML(p.id, { capitan:p.capitan||'', estado:p.finalizado||'Si', fechaValida:p.fecha||new Date(), comentario:p.comentario||'' }), titulo);
        document.getElementById(`cancel-${p.id}`).onclick = hideModal;
        document.getElementById(`save-${p.id}`).onclick = async () => {
          const cap = (document.getElementById(`cap-${p.id}`)?.value || '').trim();
          const est = (document.getElementById(`est-${p.id}`)?.value || 'Si');
          const com = (document.getElementById(`com-${p.id}`)?.value || '').trim();
          const dateStr = (document.getElementById(`fec-${p.id}`)?.value || '').trim();
          const fechaISO = dateStr ? new Date(dateStr + 'T00:00:00').toISOString() : new Date().toISOString();
          const rec = { id:p.id, territorio:String(p.territorio ?? p.id), capitan:cap, estado:est, finalizado:est, fecha:fechaISO, comentario:com };
          const res = await enviarAlSheet(rec);
          if(res.ok) showToast(`Guardado (ID ${p.id}) v√≠a ${res.via}.`); else showToast(`Guardado local (sin enviar): ${res.reason || 'error'}`);
          p.capitan = cap; p.finalizado = normalizarFinalizado(est); p.fecha = new Date(fechaISO); p.comentario = com;
          
          // üîµüü¢ Forzar feedback inmediato seg√∫n ‚Äúfinalizado‚Äù (ignora fecha)
          const lyr = layerById.get(String(p.id));
          const keyInmediata = (p.finalizado === 'Si') ? 'green' : 'blue';
          if (lyr) lyr.setStyle( estiloPorKey(keyInmediata) );

          // Mantener contadores consistentes en pantalla
          contadores = { blue:0, green:0, yellow:0, red:0 };
          for (const pol of poligonos) {
            const k = (String(pol.id) === String(p.id))
              ? keyInmediata
              : colorKeyPorFechaEstado(pol); // resto sigue con la l√≥gica normal
            contadores[k] = (contadores[k] || 0) + 1;
          }
          repintarContadores();
          hideModal();
          document.dispatchEvent(new CustomEvent('territorio:guardado', { detail:{ record: rec } }));
          //setTimeout(actualizarDesdePlanilla, 600);
        };
      }

  async function actualizarDesdePlanilla(){
    const regs = await leerPlanilla();
    if(!regs.length){ showToast('No se pudo leer la planilla'); return; }
    dataById.clear();
    for(const r of regs){
      const fid = idKey(r.id);
      if(!fid) continue;
      const prev = dataById.get(fid);
      const dt = parseFecha(r.fecha) || new Date(0);
      const prevDt = prev ? (parseFecha(prev.fecha) || new Date(0)) : new Date(0);
      if(!prev || dt >= prevDt) dataById.set(fid, r);
    }
    for(const p of poligonos){
      const rec = dataById.get(idKey(p.id));
      if(!rec) continue;
      p.capitan = rec.capitan || p.capitan || '';
      p.territorio = rec.territorio || p.territorio || p.id;
      p.finalizado = normalizarFinalizado(rec.finalizado || rec.estado || p.finalizado);
      const df = parseFecha(rec.fecha);
      p.fecha = df || p.fecha;
      p.comentario = rec.comentario || p.comentario || '';
      repintarUno(p);
    }
    showToast('Planilla aplicada');
  }

      // ====== Modal & Form ======
  function ensureUI(){
    const overlay = document.getElementById('territorio-overlay');
    const _ov = document.getElementById('territorio-overlay');
    _ov.style.display = 'flex';
    _ov.style.zIndex = String(1e6);
    if(!overlay) return;
    const closeBtn = document.getElementById('territorio-close');
    if(closeBtn) closeBtn.onclick = ()=> overlay.style.display='none';
    overlay.addEventListener('click',(e)=>{ if(e.target===overlay) overlay.style.display='none'; });
  }
  function showModal(html, title){
    ensureUI();
    console.log("showModal");
    document.getElementById('territorio-title').textContent = title || 'Registrar territorio';
    document.getElementById('territorio-body').innerHTML = html;
    document.getElementById('territorio-overlay').style.display='flex';
  }
  function hideModal(){ const o=document.getElementById('territorio-overlay'); if(o) o.style.display='none'; }

  function formHTML(id, valores={}){
    const { capitan='', estado='Si', fechaValida=new Date(), comentario='' } = valores;
    const fechaInput = fmtDateInput(fechaValida);
    return `
      <form class="form-territorio" id="form-territorio-${id}" style="font-family:system-ui,Segoe UI,Roboto,Arial">
        <div class="row" style="margin-bottom:10px">
          <label for="cap-${id}" style="display:block;margin-bottom:4px;font-weight:600;color:#333">Capit√°n</label>
          <input id="cap-${id}" value="${capitan || ''}" placeholder="Nombre del capit√°n"
                 style="width:100%;padding:8px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;box-sizing:border-box"/>
        </div>
        <div class="row" style="margin-bottom:10px">
          <label for="fec-${id}" style="display:block;margin-bottom:4px;font-weight:600;color:#333">Fecha</label>
          <input id="fec-${id}" type="date" value="${fechaInput}"
                 style="width:100%;padding:8px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;box-sizing:border-box"/>
        </div>
        <div class="row" style="margin-bottom:10px">
          <label for="est-${id}" style="display:block;margin-bottom:4px;font-weight:600;color:#333">¬øFinaliz√≥?</label>
          <select id="est-${id}" style="width:100%;padding:8px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;box-sizing:border-box">
            <option ${estado==='Si'?'selected':''} value="Si">Si</option>
            <option ${estado==='No'?'selected':''} value="No">No</option>
          </select>
        </div>
        <div class="row" style="margin-bottom:10px">
          <label for="com-${id}" style="display:block;margin-bottom:4px;font-weight:600;color:#333">Comentario</label>
          <textarea id="com-${id}" placeholder="Observaciones..." style="width:100%;padding:8px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;min-height:68px;resize:vertical;box-sizing:border-box"></textarea>
        </div>
        <div class="actions" style="display:flex;gap:8px;justify-content:flex-end">
          <button type="button" class="btn btn-cancelar" id="cancel-${id}" style="border:none;border-radius:8px;padding:8px 12px;font-weight:700;cursor:pointer;background:#e5e7eb;color:#111">Cancelar</button>
          <button type="button" class="btn btn-guardar" id="save-${id}" style="border:none;border-radius:8px;padding:8px 12px;font-weight:700;cursor:pointer;background:#2e7d32;color:#fff">Guardar</button>
        </div>
      </form>
    `;
  }

  function fmtDateInput(d){
    if(!(d instanceof Date) || isNaN(d)) d = new Date();
    const y=d.getFullYear(), m=String(d.getMonth()+1).padStart(2,'0'), day=String(d.getDate()).padStart(2,'0');
    return `${y}-${m}-${day}`;
  }

  function showToast(msg){
    const t = document.getElementById("territorio-toast");
    t.textContent = msg || "";
    t.style.display = msg ? "block" : "none";
    if(msg){ clearTimeout(showToast._t); showToast._t = setTimeout(()=>t.style.display="none", 4000); }
  }

  function repintarUno(p){
    const key = colorKeyPorFechaEstado(p);
    const lyr = layerById.get(String(p.id));
    if(lyr) lyr.setStyle( estiloPorKey(key) );
    contadores = { blue:0, green:0, yellow:0, red:0 };
    for(const pol of poligonos){
      const k = colorKeyPorFechaEstado(pol);
      contadores[k] = (contadores[k]||0)+1;
    }
    repintarContadores();
    // actualizar panel informativo si existe
    const spanId = document.getElementById('polygon-id');
    const spanFecha = document.getElementById('polygon-fecha');
    if(spanId && spanFecha && p){
      spanId.textContent = p.id;
      spanFecha.textContent = p.fecha instanceof Date && !isNaN(p.fecha) ? fmtDateInput(p.fecha) : '‚Äî';
    }
  }

    function diferenciaEnMeses(a,b){
    if(!(a instanceof Date) || isNaN(a)) return Infinity;
    let m = (b.getFullYear()-a.getFullYear())*12 + (b.getMonth()-a.getMonth());
    if(b.getDate() < a.getDate()) m -= 1;
    return m;
  }
  function colorKeyPorFechaEstado(p){
    const fechaValida = p.fecha instanceof Date && !isNaN(p.fecha);
    if(!fechaValida) return 'gray'; // sin datos -> gris
    const diffMeses = diferenciaEnMeses(p.fecha, new Date());
    if(diffMeses < 2) return p.finalizado === 'Si' ? 'green' : 'blue';
    if(diffMeses <= 3) return 'yellow';
    return 'red';
  }

  async function leerPlanilla(){
    if(READ_CSV_URL){
      try{
        const r = await fetch(READ_CSV_URL, { cache:'no-store' });
        const txt = await r.text();
        const lines = txt.split(/\r?\n/).filter(Boolean);
        if(!lines.length) return [];
        const header = lines[0].split(',').map(h=>h.trim().toLowerCase());
        const out = [];
        for(let i=1;i<lines.length;i++){
          const cols = lines[i].split(',');
          const o = {};
          cols.forEach((v,idx)=> o[header[idx] || ('col'+idx)] = (v ?? '').trim());
          out.push(o);
        }
        return out.map(o => ({
          id: o.id ?? o['territorio'] ?? '',
          fecha: o.fecha ?? o['date'] ?? '',
          finalizado: o.finalizado ?? o['estado'] ?? '',
          capitan: o.capitan ?? '',
          comentario: o.comentario ?? o['obs'] ?? '',
          territorio: o.territorio ?? ''
        }));
      }catch(e){ console.warn('Fallo CSV', e); }
    }
    try{
      const r = await fetch(WEBHOOK_URL + '?list=1', { cache:'no-store' });
      const data = await r.json();
      if(Array.isArray(data)) return data;
    }catch(e){ console.warn('Fallo ?list=1', e); }
    return [];
  }

        async function enviarAlSheet(rec){
          try{
            const body = new URLSearchParams({ payload: JSON.stringify(rec) });
            const r = await fetch(WEBHOOK_URL, { method:'POST', headers:{'Content-Type':'application/x-www-form-urlencoded;charset=utf-8'}, body });
            const text = await r.text().catch(()=>'');
            if(r.ok && /"ok"\s*:\s*true/.test(text)) return { ok:true, via:'POST' };
            if(r.status===405) throw new Error('405');
            throw new Error(text || ('HTTP '+r.status));
          }catch(err){
            try{
              const url = WEBHOOK_URL + '?' + new URLSearchParams({ payload: JSON.stringify(rec) });
              await fetch(url, { method:'GET', mode:'no-cors' });
              return { ok:true, via:'GET-no-cors' };
            }catch(e2){
              return { ok:false, reason:String(e2) };
            }
          }
        }

        (function(){
          const btn = document.getElementById("btn-geo");
          const statusEl = document.getElementById("geo-status");
          let geoEnabled = false;

          function setUI(on){
            geoEnabled = on;
            if (btn) btn.textContent = on ? "Geolocalizaci√≥n: ON" : "Geolocalizaci√≥n: OFF";
            if (!on && statusEl) statusEl.textContent = "‚Äî";
          }

          btn?.addEventListener("click", () => {
            if (!window.__geo) { console.warn("No existe window.__geo. Agreg√° los helpers startGeo/stopGeo."); return; }
            if (geoEnabled) { window.__geo.stopGeo?.(); setUI(false); }
            else { window.__geo.startGeo?.(); setUI(true); }
          });

          // Estado inicial OFF
          setUI(false);
      })();

      // Stub m√≠nimo: reemplazalo luego por tu implementaci√≥n real.
      window.__geo = window.__geo || (function(){
        let active = false;
        return {
          startGeo(){ active = true; console.log("Geo ON (stub)"); },
          stopGeo(){ active = false; console.log("Geo OFF (stub)"); }
        };
      })();

      /*************** RANKING (SIN HACER, M√ÅS ANTIGUOS) ***************/
      async function mostrarRanking() {
        try {
          const datosSheets = await cargarDatosDesdeSheets();
          if (!Array.isArray(datosSheets) || datosSheets.length === 0) {
            document.getElementById("ranking-container").innerHTML =
              "<h3>Territorios sin hacer</h3><p>No se pudieron cargar datos.</p>";
            return;
          }

          // Finalizado != 'Si'
          const sinHacer = datosSheets.filter(
            (d) => String(d.finalizado).toLowerCase() !== "si"
          );

          // Ordenar por fecha (m√°s antigua primero)
          sinHacer.sort((a, b) => a.fecha - b.fecha);

          const lista = sinHacer.slice(0, N_RANK);

          let html = "<h3>Territorios sin hacer</h3><ul>";
          const hoy = new Date();
          for (const d of lista) {
            const fechaTxt =
              d.fecha instanceof Date && !isNaN(d.fecha)
                ? d.fecha.toLocaleDateString()
                : "-";
            const meses =
              d.fecha instanceof Date && !isNaN(d.fecha)
                ? diferenciaEnMeses(d.fecha, hoy)
                : "?";
            html += `<li>${d.id} - ${fechaTxt} (${meses} mes${
              meses === 1 ? "" : "es"
            })</li>`;
          }
          html += "</ul>";

          document.getElementById("ranking-container").innerHTML = html;
        } catch (e) {
          console.error(e);
          document.getElementById("ranking-container").innerHTML =
            "<h3>Territorios sin hacer</h3><p>Error al cargar datos.</p>";
        }
      }

      /*************** INIT ***************/
      mostrarRanking();
      cargarMapa();

      // (Opcional) refrescar cada 5 minutos:
      // setInterval(() => { mostrarRanking(); /* y si quer√©s: recargar mapa */ }, 5 * 60 * 1000);

         document.addEventListener("DOMContentLoaded", function () {
        const btn = document.getElementById("toggle-referencias");
        const paneles = [
          document.getElementById("referencias"),
          document.getElementById("ranking-container"),
          document.getElementById("contador-poligonos"),
          document.getElementById("info-panel"),
        ];

        let visible = false;

        btn.addEventListener("click", function () {
          // Animaci√≥n de escala
          btn.classList.add("animate");
          setTimeout(() => btn.classList.remove("animate"), 200); // Dura lo mismo que el @keyframes

          // Mostrar u ocultar paneles
          visible = !visible;
          paneles.forEach((panel) => {
            if (panel) {
              panel.style.display = visible ? "block" : "none";
            }
          });

          // Cambiar texto del bot√≥n
          btn.textContent = visible
            ? "‚ùå Ocultar Informaci√≥n"
            : "üìã Ver Informaci√≥n";
        });
      });
    </script>
  
<!-- UI Modal para formulario de territorio + bot√≥n Actualizar -->
<div id="territorio-overlay" style="display:none;align-items:center;justify-content:center;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:10000">
  <div id="territorio-modal" role="dialog" aria-modal="true" style="width:min(440px,92vw);background:#fff;border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,.35);overflow:hidden;font-family:system-ui,Segoe UI,Roboto,Arial">
    <header style="background:#111827;color:#fff;padding:10px 12px;display:flex;justify-content:space-between;align-items:center">
      <h3 id="territorio-title" style="margin:0;font-size:14px">Registrar territorio</h3>
      <!--button type="button" id="territorio-close" class="btn btn-cancelar" style="border:none;border-radius:8px;padding:6px 10px;font-weight:700;cursor:pointer;background:#e5e7eb;color:#111">Cerrar</button-->
    </header>
    <div id="territorio-body" class="content" style="padding:12px;font-size:14px"></div>
  </div>
</div>
<div id="territorio-toast" style="position:fixed;left:12px;bottom:12px;background:rgba(255,255,255,.95);padding:6px 10px;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.15);font-size:12px;display:none;z-index:10001"></div>
<button id="btn-actualizar-sheet" title="Leer planilla y repintar" style="position:fixed;right:12px;top:12px;z-index:1200;background:#2563eb;color:#fff;border:none;padding:8px 10px;border-radius:8px;font-weight:700;cursor:pointer;visibility:hidden;">Actualizar</button>
<div id="login-overlay" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:100000;align-items:center;justify-content:center">
  <div style="width:min(420px,92vw);background:#fff;border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,.35);overflow:hidden;font-family:system-ui,Segoe UI,Roboto,Arial">
    <header style="background:#111827;color:#fff;padding:10px 12px">
      <h3 style="margin:0;font-size:14px">Iniciar sesi√≥n</h3>
    </header>
    <div style="padding:12px">
      <label style="display:block;margin:6px 0 4px">Usuario</label>
      <input id="login-user" style="width:100%;padding:8px;border:1px solid #d1d5db;border-radius:8px"/>
      <label style="display:block;margin:10px 0 4px">Contrase√±a</label>
      <input id="login-pass" type="password" style="width:100%;padding:8px;border:1px solid #d1d5db;border-radius:8px"/>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
        <button id="login-cancel" style="border:none;border-radius:8px;padding:8px 12px;background:#e5e7eb;cursor:pointer">Cancelar</button>
        <button id="login-ok" style="border:none;border-radius:8px;padding:8px 12px;background:#2563eb;color:#fff;cursor:pointer">Entrar</button>
      </div>
    </div>
  </div>
</div>

<script>
  function openLoginModal(onSubmit){
    const ov = document.getElementById('login-overlay');
    const user = document.getElementById('login-user');
    const pass = document.getElementById('login-pass');
    const ok   = document.getElementById('login-ok');
    const cc   = document.getElementById('login-cancel');
    ov.style.display = 'flex';
    user.value = ''; pass.value = ''; user.focus();

    const close = ()=> { ov.style.display = 'none'; ok.onclick = cc.onclick = null; };
    cc.onclick = close;
    ok.onclick = ()=> onSubmit({ usuario: user.value, password: pass.value, close });
    ov.addEventListener('click', (e)=>{ if(e.target===ov) close(); }, { once:true });
  }

(function(){
  // ====== CONFIG ======
  const WEBHOOK_URL = "https://script.google.com/macros/s/AKfycbweVDu_2Vn0ygEMQdkgqbVprTKJ2kjAT--Wimo0cVTaASLK3-yJMkt175DJq-pky1Y/exec";
  const READ_CSV_URL = (typeof SHEET_CSV !== "undefined" && SHEET_CSV) ? SHEET_CSV : "";
  if (typeof map === 'undefined') { console.error('No existe el mapa Leaflet "map".'); return; }
  if (typeof poligonos === 'undefined') { window.poligonos = []; }

  // ====== Estado ======
  const territoriosLayer = L.featureGroup().addTo(map);
  const layerById = new Map();
  const dataById  = new Map();
  let contadores = { blue:0, green:0, yellow:0, red:0 };

  // ====== Helpers ======
function normalizarId(x) {
  let s = String(x ?? "")
    .normalize("NFKC")
    // quita espacios invisibles (ZWSP, etc.)
    .replace(/[\u200B\u200C\u200D\u2060\uFEFF]/g, "")
    // convierte todos los espacios unicode a espacio com√∫n y colapsa
    .replace(/[\u00A0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/g, " ")
    .replace(/\s+/g, " ")
    .trim();

  if (!s) return "";

  // si quer√©s mantener ceros a la izquierda, cambi√° por: const stripZeros = v => v;
  const stripZeros = (v) => v.replace(/^0+/, "") || "0";

  // 1) Solo d√≠gitos
  if (/^\d+$/.test(s)) return stripZeros(s);

  // 2) Prioridad: √∫ltimos d√≠gitos al final del string (cubre "705|6 301" ‚Üí "301", "12|34" ‚Üí "34")
  let m = s.match(/(\d+)\s*$/);
  if (m) return stripZeros(m[1]);

  // 3) Caso "AA|BB" (sin n√∫meros al final) ‚Üí d√≠gitos a la derecha de la √∫ltima barra
  if (s.includes("|")) {
    const right = s.split("|").pop();
    m = right.match(/(\d+)(?!.*\d)/);
    if (m) return stripZeros(m[1]);
  }

  // 4) Fallback: √∫ltimo grupo num√©rico donde sea
  const all = s.match(/\d+/g);
  if (all && all.length) return stripZeros(all[all.length - 1]);

  return s; // sin n√∫meros, devolvemos original
}


  const $ = (sel)=> document.querySelector(sel);
  function idKey(x){ return String(x ?? "").split("|")[0].trim(); }
  function parseFecha(s){
    if(!s) return null;
    const t = String(s).trim();
    const d1 = new Date(t); if(!isNaN(d1)) return d1;
    const m = t.match(/^([0-3]?\d)[\/\-]([0-1]?\d)[\/\-](\d{4})$/);
    if(m){ const [_,dd,mm,yy]=m; return new Date(parseInt(yy), parseInt(mm)-1, parseInt(dd)); }
    const m2 = t.match(/^(\d{4})[\/\-]([0-1]?\d)[\/\-]([0-3]?\d)$/);
    if(m2){ const [_,yy,mm,dd]=m2; return new Date(parseInt(yy), parseInt(mm)-1, parseInt(dd)); }
    return null;
  }
  function normalizarFinalizado(v){
    const s = String(v ?? '').trim().toLowerCase();
    if(!s) return '';
    if(['si','s√≠','s','true','1','ok','finalizado','completo','terminado'].includes(s)) return 'Si';
    if(['no','n','false','0','pendiente','incompleto','en curso','trabajando'].includes(s)) return 'No';
    return s;
  }

function estiloPorKey(key){
  const base = { color:'#333', weight:1, fillOpacity:0.35 };
  if(key==='blue')   return { ...base, fillColor:'#3388ff' };
  if(key==='green')  return { ...base, fillColor:'#2e7d32' };
  if(key==='yellow') return { ...base, fillColor:'#ffd500' };
  if(key==='red')    return { ...base, fillColor:'#b53a22' };
  if(key==='gray')   return { ...base, fillColor:'#9e9e9e' }; // ‚Üê NUEVO
  return { ...base, fillColor:'#90caf9' };
}


  


  // ====== Pintado ======
function bindLayerEvents(layer, p){
  // Solo click -> abrir formulario. NO tooltip aqu√≠ para evitar ID duplicado.
  layer.on('click', (e) => {
    try { if (e && e.originalEvent) L.DomEvent.stop(e.originalEvent); } catch (_) {}
    abrirForm(p);
  });
}


  function drawPoligonos(){
    territoriosLayer.clearLayers();
    layerById.clear();
    contadores = { blue:0, green:0, yellow:0, red:0 };

    (poligonos||[]).forEach(p => {
      p.finalizado = normalizarFinalizado(p.finalizado);
      if(p.fecha && !(p.fecha instanceof Date)){ const df = parseFecha(p.fecha); p.fecha = df || null; }
      const key = colorKeyPorFechaEstado(p);
      const layer = L.polygon(p.coords, estiloPorKey(key));
      bindLayerEvents(layer, p);
      layer.addTo(territoriosLayer);
      layerById.set(String(p.id), layer);
      contadores[key] = (contadores[key]||0)+1;
    });
    try{ map.fitBounds(territoriosLayer.getBounds(), { padding:[20,20] }); }catch(_){}
    repintarContadores();
  }

  // ====== Lectura planilla ======
  


  // ====== Init ======
  document.getElementById('btn-actualizar-sheet').addEventListener('click', actualizarDesdePlanilla);
  drawPoligonos();
})();
</script>

<nav class="bottom-bar" role="toolbar" aria-label="Opciones">
  <div class="group">
    <button id="btn-geo-on" class="bar-btn" type="button">Activar geolocalizaci√≥n</button>
    <button id="btn-geo-off" class="bar-btn" type="button" disabled>Desactivar</button>
    <span id="geo-status" class="bar-text" style="visibility: hidden;">‚Äî</span>
    <button id="btn-login" class="bar-btn-login" type="button">Iniciar Sesi√≥n</button>
    </div>

  <div class="group" id="more-actions">
    <!-- Ejemplos de acciones extras -->
    <!-- Si quer√©s que se bloqueen autom√°ticamente cuando est√°s >8km, agreg√° data-requires-geo="true" -->
    <!-- <button class="bar-btn">Otra acci√≥n</button> -->
  </div>
</nav>
</body>
</html>
